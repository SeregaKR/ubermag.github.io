
<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Field &#8212; ubermag  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/colours.css?v=f1e252c1" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=fd10adb8"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/_autosummary/discretisedfield.Field';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FieldRotator" href="discretisedfield.FieldRotator.html" />
    <link rel="prev" title="discretisedfield" href="discretisedfield.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logoL.png" class="logo__image only-light" alt="ubermag  documentation - Home"/>
    <script>document.write(`<img src="../../_static/logoL.png" class="logo__image only-dark" alt="ubermag  documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../demo.html">
                        Demo
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../documentation.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../changelog.html">
                        Changelog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../help.html">
                        Help
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributing.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../news.html">
                        News
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ubermag" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../demo.html">
                        Demo
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../documentation.html">
                        Documentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../changelog.html">
                        Changelog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../help.html">
                        Help
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../contributing.html">
                        Contributing
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../news.html">
                        News
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ubermag" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting-started/index.html">Getting started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/notebooks/python-basics.html">Python basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/jupyter-basics.html">Jupyter lab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/notebooks/first-ubermag-simulation.html">Our first ubermag simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/notebooks/magnetisation-field.html">Magnetisation field</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/notebooks/energy-equation.html">Energy equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/notebooks/dynamics-equation.html">Dynamics equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/notebooks/dw-pair-conversion.html">Exercise: Domain wall pair conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting-started/notebooks/unit-converter.html">Unit Conversions</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/index.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/07-tutorial-standard-problem3.html">Standard problem 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/08-tutorial-standard-problem4.html">Standard problem 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/09-tutorial-standard-problem5.html">Standard problem 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/10-tutorial-standard-problem-fmr.html">FMR standard problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/11-tutorial-deriving-fields.html">Deriving energy values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/12-tutorial-stray-field.html">Calculating a stray field using an airbox method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/13-tutorial-skyrmion.html">Skyrmion in a disk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/STT-dw-motion.html">Current induced domain wall motion using STT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/choosing-runner.html">Choosing runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/energy-term-computations.html">Energy term computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/field-operations2.html">Field operations 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/finite-temperature.html">Simulation at finite temperature</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/fixed-subregions.html">Fixed subregions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/hysteresis.html">Hysteresis simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/multiple-terms.html">Multiple energy terms of the same class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/negative-A.html">Negative exchange energy constant</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/periodic-boundary-conditions.html">Periodic boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/rkky.html">RKKY energy term</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/sine-hysteresis.html">Sine-hysteresis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/space-time-field.html">Both spatially and time varying field</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/spatially-varying-parameters1.html">Spatially varying parameters 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/spatially-varying-parameters2.html">Spatially varying parameters 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/time-dependent-field.html">Time-varying field</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/notebooks/time-dependent-field-current.html">Time-dependent fields and currents</a></li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../documentation/index.html">Package documentation</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/discretisedfield.html">discretisedfield</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/region-basics.html">Region basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/region-visualisation.html">Region visualisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/region-facing-surfaces.html">Region facing surfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/mesh-basics.html">Mesh basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/mesh-visualisation.html">Mesh visualisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/mesh-line-plane.html">Mesh plane and line</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/mesh-subregions.html">Mesh subregions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/mesh-widgets.html">Mesh widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/mesh-pad.html">Mesh pad</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/mesh-bc.html">Mesh boundary conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-definition.html">Defining a uniform field</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-spatially-varying.html">Spatially varying fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-normalisation.html">Field normalisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-valid.html">Field <code class="docutils literal notranslate"><span class="pre">Valid</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-operations.html">Field operations</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-matplotlib-visualisation.html">Visualising field using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-k3d-visualisation.html">Field visualisation using <code class="docutils literal notranslate"><span class="pre">k3d</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-holoviews-visualisation.html">Visualising field using <code class="docutils literal notranslate"><span class="pre">holoviews</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-read-write.html">Reading and writing fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-fft.html">FFT Tutorial with <code class="docutils literal notranslate"><span class="pre">discretisedfield</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/xarray-usage.html">Importing/Exporting field from/to <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-rotations.html">Field rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/field-tools.html">Field tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/line.html">Line object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/discretisedfield/ovf2vtk.html"><code class="docutils literal notranslate"><span class="pre">ovf2vtk</span></code> tool</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/mag2exp.html">mag2exp</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/mag2exp/DC_magnetometry.html">DC magnetometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/mag2exp/Torque_magnetometry.html">Torque magnetometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/mag2exp/Lorentz_TEM.html">Lorentz Transmission Electron Microscopy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/mag2exp/Rotations_Lorentz_Microscopy.html">Using Rotations with <code class="docutils literal notranslate"><span class="pre">mag2exp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/mag2exp/Magnetic_Force_Microscopy.html">Magnetic Force Microscopy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/mag2exp/X_ray_Holography.html">X-ray Holography</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/mag2exp/SAXS.html">Small Angle X-ray Scattering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/mag2exp/SANS.html">Small Angle Neutron Scattering</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/micromagneticdata.html">micromagneticdata</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticdata/documentation.html">Analysing simulation results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticdata/interactive_plotting.html">Interactive plots</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/micromagneticmodel.html">micromagneticmodel</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticmodel/deriving-energy-term.html">Deriving an energy term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticmodel/deriving-dynamics-term.html">Deriving a dynamics term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticmodel/term-parameters.html">Term parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticmodel/energy-terms.html">Energy terms and energy equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticmodel/dynamics-terms.html">Dynamics terms and dynamics equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticmodel/same-class-terms.html">Multiple energy terms of the same class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticmodel/evolver-driver.html">Deriving evolver and driver classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticmodel/system.html">Defining micromagnetic system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagneticmodel/constants.html">Constants</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/micromagnetictests.html">micromagnetictests</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/micromagnetictests/usage.html">Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/mumax3c.html">mumax3c</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/oommfc.html">oommfc</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/zeeman.html">Tutorial 01: Zeeman energy term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/exchange.html">Tutorial 02: Exchange energy term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/uniaxialanisotropy.html">Tutorial 03: Uniaxial anisotropy energy term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/dmi.html">Tutorial 04: Dzyaloshinskii-Moriya energy term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/cubicanisotropy.html">Tutorial 05: Cubic anisotropy energy term</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/mindriver-steps.html"><code class="docutils literal notranslate"><span class="pre">MinDriver</span></code> steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/dirname.html">Custom directory name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/controlling-default-runner.html">Controlling the default runner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/parallel.html">Running simulations in parallel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/oommfc/verbosity_levels.html">Verbosity levels</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/ubermagtable.html">ubermagtable</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagtable/table-basics.html">Table basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagtable/table-merge.html">Table merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagtable/table-visualisation.html">Table visualisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagtable/table-widgets.html">Table widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagtable/table-interactive-plot.html">Table interactive plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagtable/table-fft.html">Table FFT</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/ubermagutil.html">ubermagutil</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagutil/imposing-typesystem.html">Imposing <code class="docutils literal notranslate"><span class="pre">typesystem</span></code> on a class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagutil/constant-attributes.html">Constant attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagutil/parameter-descriptor.html"><code class="docutils literal notranslate"><span class="pre">Parameter</span></code> descriptor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagutil/otherwise-type.html">Defining <code class="docutils literal notranslate"><span class="pre">otherwise</span></code> type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagutil/si-prefix.html">Extracting the SI prefix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagutil/inherit-docs.html"><code class="docutils literal notranslate"><span class="pre">inherit_docs</span></code> decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagutil/hysteresis.html">Hysteresis values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermagutil/logging.html">Logging control</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../documentation/ubermag.html">ubermag</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermag/ubermag-version.html">Collecting debug information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../documentation/notebooks/ubermag/hdf5-file-specification.html">HDF5 specification in Ubermag</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../documentation/compatibility.html">Compatibility</a></li>
</ul>
</li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="discretisedfield.html">discretisedfield</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Field</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretisedfield.FieldRotator.html">FieldRotator</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretisedfield.Line.html">Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretisedfield.Mesh.html">Mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretisedfield.Region.html">Region</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretisedfield.integrate.html">discretisedfield.integrate</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretisedfield.interact.html">discretisedfield.interact</a></li>
<li class="toctree-l3"><a class="reference internal" href="discretisedfield.test.html">discretisedfield.test</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="discretisedfield.io.html">discretisedfield.io</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.io.ovf2vtk.html">discretisedfield.io.ovf2vtk</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="discretisedfield.plotting.html">discretisedfield.plotting</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.plotting.Hv.html">Hv</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.plotting.K3dField.html">K3dField</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.plotting.K3dMesh.html">K3dMesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.plotting.K3dRegion.html">K3dRegion</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.plotting.MplField.html">MplField</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.plotting.MplMesh.html">MplMesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.plotting.MplRegion.html">MplRegion</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.plotting.add_colorwheel.html">discretisedfield.plotting.add_colorwheel</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="discretisedfield.tools.html">discretisedfield.tools</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.tools.count_bps.html">discretisedfield.tools.count_bps</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.tools.count_large_cell_angle_regions.html">discretisedfield.tools.count_large_cell_angle_regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.tools.demag_field.html">discretisedfield.tools.demag_field</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.tools.demag_tensor.html">discretisedfield.tools.demag_tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.tools.emergent_magnetic_field.html">discretisedfield.tools.emergent_magnetic_field</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.tools.max_neighbouring_cell_angle.html">discretisedfield.tools.max_neighbouring_cell_angle</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.tools.neighbouring_cell_angle.html">discretisedfield.tools.neighbouring_cell_angle</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.tools.topological_charge.html">discretisedfield.tools.topological_charge</a></li>
<li class="toctree-l4"><a class="reference internal" href="discretisedfield.tools.topological_charge_density.html">discretisedfield.tools.topological_charge_density</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="mag2exp.html">mag2exp</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="mag2exp.test.html">mag2exp.test</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mag2exp.ltem.html">mag2exp.ltem</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.ltem.defocus_image.html">mag2exp.ltem.defocus_image</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.ltem.integrated_magnetic_flux_density.html">mag2exp.ltem.integrated_magnetic_flux_density</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.ltem.phase.html">mag2exp.ltem.phase</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.ltem.relativistic_wavelength.html">mag2exp.ltem.relativistic_wavelength</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mag2exp.magnetometry.html">mag2exp.magnetometry</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.magnetometry.magnetisation.html">mag2exp.magnetometry.magnetisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.magnetometry.torque.html">mag2exp.magnetometry.torque</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mag2exp.mfm.html">mag2exp.mfm</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.mfm.phase_shift.html">mag2exp.mfm.phase_shift</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mag2exp.quick_plots.html">mag2exp.quick_plots</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.quick_plots.ltem_defocus.html">mag2exp.quick_plots.ltem_defocus</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.quick_plots.ltem_ft_phase.html">mag2exp.quick_plots.ltem_ft_phase</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.quick_plots.ltem_integrated_mfd.html">mag2exp.quick_plots.ltem_integrated_mfd</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.quick_plots.ltem_phase.html">mag2exp.quick_plots.ltem_phase</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.quick_plots.mfm_phase_shift.html">mag2exp.quick_plots.mfm_phase_shift</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.quick_plots.sans_chiral_function.html">mag2exp.quick_plots.sans_chiral_function</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.quick_plots.sans_cross_section.html">mag2exp.quick_plots.sans_cross_section</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.quick_plots.saxs.html">mag2exp.quick_plots.saxs</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.quick_plots.x_ray_holography.html">mag2exp.quick_plots.x_ray_holography</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mag2exp.sans.html">mag2exp.sans</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.sans.chiral_function.html">mag2exp.sans.chiral_function</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.sans.cross_section.html">mag2exp.sans.cross_section</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mag2exp.x_ray.html">mag2exp.x_ray</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.x_ray.holography.html">mag2exp.x_ray.holography</a></li>
<li class="toctree-l4"><a class="reference internal" href="mag2exp.x_ray.saxs.html">mag2exp.x_ray.saxs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="micromagneticdata.html">micromagneticdata</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="micromagneticdata.AbstractDrive.html">AbstractDrive</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticdata.CombinedDrive.html">CombinedDrive</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticdata.Data.html">Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticdata.Drive.html">Drive</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticdata.Mumax3Drive.html">Mumax3Drive</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticdata.OOMMFDrive.html">OOMMFDrive</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticdata.test.html">micromagneticdata.test</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="micromagneticmodel.html">micromagneticmodel</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.CubicAnisotropy.html">CubicAnisotropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.DMI.html">DMI</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Damping.html">Damping</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Demag.html">Demag</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Driver.html">Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Dynamics.html">Dynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.DynamicsTerm.html">DynamicsTerm</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Energy.html">Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.EnergyTerm.html">EnergyTerm</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Evolver.html">Evolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Exchange.html">Exchange</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.ExternalDriver.html">ExternalDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.ExternalRunner.html">ExternalRunner</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.MagnetoElastic.html">MagnetoElastic</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Precession.html">Precession</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.RKKY.html">RKKY</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Slonczewski.html">Slonczewski</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.System.html">System</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.UniaxialAnisotropy.html">UniaxialAnisotropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.Zeeman.html">Zeeman</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.ZhangLi.html">ZhangLi</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagneticmodel.test.html">micromagneticmodel.test</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="micromagneticmodel.abstract.html">micromagneticmodel.abstract</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.abstract.Abstract.html">Abstract</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.abstract.Container.html">Container</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.abstract.Term.html">Term</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="micromagneticmodel.consts.html">micromagneticmodel.consts</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.mu0.html">micromagneticmodel.consts.mu0</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.e.html">micromagneticmodel.consts.e</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.me.html">micromagneticmodel.consts.me</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.kB.html">micromagneticmodel.consts.kB</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.h.html">micromagneticmodel.consts.h</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.g.html">micromagneticmodel.consts.g</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.hbar.html">micromagneticmodel.consts.hbar</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.gamma.html">micromagneticmodel.consts.gamma</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.muB.html">micromagneticmodel.consts.muB</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.consts.gamma0.html">micromagneticmodel.consts.gamma0</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="micromagneticmodel.examples.html">micromagneticmodel.examples</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="micromagneticmodel.examples.macrospin.html">micromagneticmodel.examples.macrospin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="micromagnetictests.html">micromagnetictests</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="micromagnetictests.get_tests.html">micromagnetictests.get_tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="micromagnetictests.test.html">micromagnetictests.test</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="micromagnetictests.calculatortests.html">micromagnetictests.calculatortests</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestCompute.html">TestCompute</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestCubicAnisotropy.html">TestCubicAnisotropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestDMI.html">TestDMI</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestDamping.html">TestDamping</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestDemag.html">TestDemag</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestDynamics.html">TestDynamics</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestEnergy.html">TestEnergy</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestExchange.html">TestExchange</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestFixedSubregions.html">TestFixedSubregions</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestHysteresisDriver.html">TestHysteresisDriver</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestMesh.html">TestMesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestMinDriver.html">TestMinDriver</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestPrecession.html">TestPrecession</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestRKKY.html">TestRKKY</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestSlonczewski.html">TestSlonczewski</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestThreads.html">TestThreads</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestTimeDriver.html">TestTimeDriver</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestUniaxialAnisotropy.html">TestUniaxialAnisotropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestZeeman.html">TestZeeman</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.TestZhangLi.html">TestZhangLi</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_dirname.html">micromagnetictests.calculatortests.test_dirname</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_format.html">micromagnetictests.calculatortests.test_format</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_info_file.html">micromagnetictests.calculatortests.test_info_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_multiple_drives.html">micromagnetictests.calculatortests.test_multiple_drives</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_outputstep.html">micromagnetictests.calculatortests.test_outputstep</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_schedule.html">micromagnetictests.calculatortests.test_schedule</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_skyrmion.html">micromagnetictests.calculatortests.test_skyrmion</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_stdprob3.html">micromagnetictests.calculatortests.test_stdprob3</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_stdprob4.html">micromagnetictests.calculatortests.test_stdprob4</a></li>
<li class="toctree-l4"><a class="reference internal" href="micromagnetictests.calculatortests.test_stdprob5.html">micromagnetictests.calculatortests.test_stdprob5</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="mumax3c.html">mumax3c</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-32"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="mumax3c.runner.html">mumax3c.runner</a></li>
<li class="toctree-l3"><a class="reference internal" href="mumax3c.MinDriver.html">MinDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="mumax3c.RelaxDriver.html">RelaxDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="mumax3c.TimeDriver.html">TimeDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="mumax3c.delete.html">mumax3c.delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="mumax3c.test.html">mumax3c.test</a></li>
<li class="toctree-l3"><a class="reference internal" href="mumax3c.test_docker.html">mumax3c.test_docker</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="mumax3c.mumax3.html">mumax3c.mumax3</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-33"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="mumax3c.mumax3.ExeMumax3Runner.html">ExeMumax3Runner</a></li>
<li class="toctree-l4"><a class="reference internal" href="mumax3c.mumax3.Mumax3Runner.html">Mumax3Runner</a></li>
<li class="toctree-l4"><a class="reference internal" href="mumax3c.mumax3.Runner.html">Runner</a></li>
<li class="toctree-l4"><a class="reference internal" href="mumax3c.mumax3.overhead.html">mumax3c.mumax3.overhead</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="oommfc.html">oommfc</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-34"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="oommfc.runner.html">oommfc.runner</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.CGEvolver.html">CGEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.Driver.html">Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.EulerEvolver.html">EulerEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.HysteresisDriver.html">HysteresisDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.MinDriver.html">MinDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.RungeKuttaEvolver.html">RungeKuttaEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.SpinTEvolver.html">SpinTEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.SpinXferEvolver.html">SpinXferEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.TimeDriver.html">TimeDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.UHH_ThetaEvolver.html">UHH_ThetaEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.Xf_ThermHeunEvolver.html">Xf_ThermHeunEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.Xf_ThermSpinXferEvolver.html">Xf_ThermSpinXferEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.compute.html">oommfc.compute</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.delete.html">oommfc.delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.test.html">oommfc.test</a></li>
<li class="toctree-l3"><a class="reference internal" href="oommfc.test_docker.html">oommfc.test_docker</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="oommfc.oommf.html">oommfc.oommf</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-35"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="oommfc.oommf.DockerOOMMFRunner.html">DockerOOMMFRunner</a></li>
<li class="toctree-l4"><a class="reference internal" href="oommfc.oommf.ExeOOMMFRunner.html">ExeOOMMFRunner</a></li>
<li class="toctree-l4"><a class="reference internal" href="oommfc.oommf.OOMMFRunner.html">OOMMFRunner</a></li>
<li class="toctree-l4"><a class="reference internal" href="oommfc.oommf.Runner.html">Runner</a></li>
<li class="toctree-l4"><a class="reference internal" href="oommfc.oommf.TclOOMMFRunner.html">TclOOMMFRunner</a></li>
<li class="toctree-l4"><a class="reference internal" href="oommfc.oommf.overhead.html">oommfc.oommf.overhead</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="ubermag.html">ubermag</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-36"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="ubermag.debug_info.html">ubermag.debug_info</a></li>
<li class="toctree-l3"><a class="reference internal" href="ubermag.test.html">ubermag.test</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="ubermagtable.html">ubermagtable</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-37"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="ubermagtable.Table.html">Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="ubermagtable.interact.html">ubermagtable.interact</a></li>
<li class="toctree-l3"><a class="reference internal" href="ubermagtable.test.html">ubermagtable.test</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="ubermagtable.util.html">ubermagtable.util</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-38"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="ubermagtable.util.columns.html">ubermagtable.util.columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagtable.util.data.html">ubermagtable.util.data</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagtable.util.units.html">ubermagtable.util.units</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="ubermagutil.html">ubermagutil</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-39"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="ubermagutil.changedir.html">ubermagutil.changedir</a></li>
<li class="toctree-l3"><a class="reference internal" href="ubermagutil.hysteresis_values.html">ubermagutil.hysteresis_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="ubermagutil.inherit_docs.html">ubermagutil.inherit_docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="ubermagutil.setup_logging.html">ubermagutil.setup_logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="ubermagutil.test.html">ubermagutil.test</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="ubermagutil.typesystem.html">ubermagutil.typesystem</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-40"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.typesystem.Descriptor.html">Descriptor</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.typesystem.Dictionary.html">Dictionary</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.typesystem.Name.html">Name</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.typesystem.Parameter.html">Parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.typesystem.Scalar.html">Scalar</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.typesystem.Subset.html">Subset</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.typesystem.Typed.html">Typed</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.typesystem.Vector.html">Vector</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.typesystem.typesystem.html">ubermagutil.typesystem.typesystem</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="ubermagutil.units.html">ubermagutil.units</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-41"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.units.si_max_multiplier.html">ubermagutil.units.si_max_multiplier</a></li>
<li class="toctree-l4"><a class="reference internal" href="ubermagutil.units.si_multiplier.html">ubermagutil.units.si_multiplier</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../documentation.html" class="nav-link">Documentation</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="discretisedfield.html" class="nav-link">discretisedfield</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Field</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="field">
<h1>Field<a class="headerlink" href="#field" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="discretisedfield.Field">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">discretisedfield.</span></span><span class="sig-name descname"><span class="pre">Field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nvdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdim_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field" title="Link to this definition">#</a></dt>
<dd><p>Finite-difference field.</p>
<p>This class specifies a finite-difference field and defines operations for
its analysis and visualisation. The field is defined on a finite-difference
mesh (<cite>discretisedfield.Mesh</cite>) passed using <code class="docutils literal notranslate"><span class="pre">mesh</span></code>. Another value that
must be passed is the dimension of the field’s value using <code class="docutils literal notranslate"><span class="pre">nvdim</span></code>. For
instance, for a scalar field, <code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code> and for a three-dimensional vector
field <code class="docutils literal notranslate"><span class="pre">nvdim=3</span></code> must be passed. The value of the field can be set by
passing <code class="docutils literal notranslate"><span class="pre">value</span></code>. For details on how the value can be defined, refer to
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.value</span></code>. Similarly, if the field has <code class="docutils literal notranslate"><span class="pre">nvdim&gt;1</span></code>,
the field can be normalised by passing <code class="docutils literal notranslate"><span class="pre">norm</span></code>. For details on setting the
norm, please refer to <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.norm</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> (<a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh" title="discretisedfield.Mesh"><em>discretisedfield.Mesh</em></a>) – Finite-difference rectangular mesh.</p></li>
<li><p><strong>nvdim</strong> (<em>int</em>) – Number of Value dimensions of the field. For instance, if <cite>nvdim=3</cite> the field is
a three-dimensional vector field and for <cite>nvdim=1</cite> the field is a scalar field.</p></li>
<li><p><strong>value</strong> (<em>array_like</em><em>, </em><em>callable</em><em>, </em><em>dict</em><em>, </em><em>optional</em>) – Please refer to <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.value</span></code> property. Defaults to
0, meaning that if the value is not provided in the initialisation,
“zero-field” will be defined.</p></li>
<li><p><strong>norm</strong> (<em>numbers.Real</em><em>, </em><em>callable</em><em>, </em><em>optional</em>) – Please refer to <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.norm</span></code> property. Defaults to
<code class="docutils literal notranslate"><span class="pre">None</span></code> (<code class="docutils literal notranslate"><span class="pre">norm=None</span></code> defines no norm).</p></li>
<li><p><strong>dtype</strong> (<em>str</em><em>, </em><em>type</em><em>, </em><em>np.dtype</em><em>, </em><em>optional</em>) – Data type of the underlying numpy array. If not specified the best data
type is automatically determined if <code class="docutils literal notranslate"><span class="pre">value</span></code> is  array_like, for
callable and dict <code class="docutils literal notranslate"><span class="pre">value</span></code> the numpy default (currently
<code class="docutils literal notranslate"><span class="pre">float64</span></code>) is used. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>unit</strong> (<em>str</em><em>, </em><em>optional</em>) – Physical unit of the field.</p></li>
<li><p><strong>valid</strong> (<em>numpy.ndarray</em><em>, </em><em>str</em><em>, </em><em>optional</em>) – Property used to mask invalid values of the field. Please refer to
<code class="docutils literal notranslate"><span class="pre">discretisedfield.Field.valid</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>vdim_mapping</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary that maps value dimensions to the spatial dimensions. It defaults to
the same as spatial dimensions if the number of value and spatial dimensions are
the same, else it is empty.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>1. Defining a uniform three-dimensional vector field on a nano-sized thin
film.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">50e-9</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e-9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">50e-9</span><span class="p">,</span> <span class="mf">25e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="mf">0.1e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nvdim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="n">nvdim</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 1.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Defining a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nvdim</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="mf">3.14</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="n">nvdim</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([3.14])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Defining a uniform three-dimensional normalised vector field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">50e9</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">50e9</span><span class="p">,</span> <span class="mf">25e9</span><span class="p">,</span> <span class="mf">5e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e9</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">0.1e9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nvdim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="n">nvdim</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 1.])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh" title="discretisedfield.Mesh"><code class="xref py py-func docutils literal notranslate"><span class="pre">Mesh()</span></code></a></p>
</div>
<hr><p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__abs__" title="discretisedfield.Field.__abs__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__abs__</span></code></a></p></td>
<td><p>Absolute value of the field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__add__" title="discretisedfield.Field.__add__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__add__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__and__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__array_ufunc__" title="discretisedfield.Field.__array_ufunc__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__array_ufunc__</span></code></a></p></td>
<td><p>Field class support for numpy <code class="docutils literal notranslate"><span class="pre">ufuncs</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__call__" title="discretisedfield.Field.__call__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code></a></p></td>
<td><p>Sample the field value at <code class="docutils literal notranslate"><span class="pre">point</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__dir__" title="discretisedfield.Field.__dir__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__dir__</span></code></a></p></td>
<td><p>Extension of the <code class="docutils literal notranslate"><span class="pre">dir(self)</span></code> list.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__eq__" title="discretisedfield.Field.__eq__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__eq__</span></code></a></p></td>
<td><p>Relational operator <code class="docutils literal notranslate"><span class="pre">==</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__getattr__" title="discretisedfield.Field.__getattr__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getattr__</span></code></a></p></td>
<td><p>Extract the component of the vector field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__getitem__" title="discretisedfield.Field.__getitem__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getitem__</span></code></a></p></td>
<td><p>Extracts the field on a subregion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__iter__" title="discretisedfield.Field.__iter__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__iter__</span></code></a></p></td>
<td><p>Generator yielding field values of all discretisation cells.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__lshift__" title="discretisedfield.Field.__lshift__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__lshift__</span></code></a></p></td>
<td><p>Stacks multiple scalar fields in a single vector field.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__matmul__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__mul__" title="discretisedfield.Field.__mul__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__mul__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">*</span></code> operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__neg__" title="discretisedfield.Field.__neg__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__neg__</span></code></a></p></td>
<td><p>Unary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__pos__" title="discretisedfield.Field.__pos__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__pos__</span></code></a></p></td>
<td><p>Unary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__pow__" title="discretisedfield.Field.__pow__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__pow__</span></code></a></p></td>
<td><p>Unary <code class="docutils literal notranslate"><span class="pre">**</span></code> operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__repr__" title="discretisedfield.Field.__repr__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__repr__</span></code></a></p></td>
<td><p>Representation string.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.__sub__" title="discretisedfield.Field.__sub__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__sub__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.__truediv__" title="discretisedfield.Field.__truediv__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__truediv__</span></code></a></p></td>
<td><p>Binary <code class="docutils literal notranslate"><span class="pre">/</span></code> operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.allclose" title="discretisedfield.Field.allclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allclose</span></code></a></p></td>
<td><p>Allclose method.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.angle" title="discretisedfield.Field.angle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">angle</span></code></a></p></td>
<td><p>Angle between two vectors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.cross" title="discretisedfield.Field.cross"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cross</span></code></a></p></td>
<td><p>Cross product.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.diff" title="discretisedfield.Field.diff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diff</span></code></a></p></td>
<td><p>Directional derivative.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.dot" title="discretisedfield.Field.dot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dot</span></code></a></p></td>
<td><p>Dot product.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.fftn" title="discretisedfield.Field.fftn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fftn</span></code></a></p></td>
<td><p>Performs an N-dimensional discrete Fast Fourier Transform (FFT) on the field.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_file</span></code></p></td>
<td><p>Read a field from an OVF (1.0 or 2.0), VTK, or HDF5 file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.from_xarray" title="discretisedfield.Field.from_xarray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_xarray</span></code></a></p></td>
<td><p>Create <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> from <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fromfile</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.ifftn" title="discretisedfield.Field.ifftn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ifftn</span></code></a></p></td>
<td><p>Performs an N-dimensional discrete inverse Fast Fourier Transform (iFFT) on the field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.integrate" title="discretisedfield.Field.integrate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">integrate</span></code></a></p></td>
<td><p>Integral.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.irfftn" title="discretisedfield.Field.irfftn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">irfftn</span></code></a></p></td>
<td><p>Performs an N-dimensional discrete inverse real Fast Fourier Transform (irFFT) on the field.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_same_vectorspace</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.line" title="discretisedfield.Field.line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">line</span></code></a></p></td>
<td><p>Sample the field along the line.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.mean" title="discretisedfield.Field.mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean</span></code></a></p></td>
<td><p>Field mean.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.pad" title="discretisedfield.Field.pad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pad</span></code></a></p></td>
<td><p>Field padding.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.resample" title="discretisedfield.Field.resample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">resample</span></code></a></p></td>
<td><p>Resample field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.rfftn" title="discretisedfield.Field.rfftn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rfftn</span></code></a></p></td>
<td><p>Performs an N-dimensional discrete real Fast Fourier Transform (rFFT) on the field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.rotate90" title="discretisedfield.Field.rotate90"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotate90</span></code></a></p></td>
<td><p>Rotate field and underlying mesh by 90°.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.sel" title="discretisedfield.Field.sel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sel</span></code></a></p></td>
<td><p>Select a part of the field.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_file</span></code></p></td>
<td><p>Write the field to OVF, HDF5, or VTK file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.to_vtk" title="discretisedfield.Field.to_vtk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_vtk</span></code></a></p></td>
<td><p>Convert field to vtk rectilinear grid.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.to_xarray" title="discretisedfield.Field.to_xarray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_xarray</span></code></a></p></td>
<td><p>Field value as <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.update_field_values" title="discretisedfield.Field.update_field_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_field_values</span></code></a></p></td>
<td><p>Set field value representation.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Properties</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.abs" title="discretisedfield.Field.abs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">abs</span></code></a></p></td>
<td><p>Absolute value of complex field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.array" title="discretisedfield.Field.array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></p></td>
<td><p>Field value as <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.conjugate" title="discretisedfield.Field.conjugate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">conjugate</span></code></a></p></td>
<td><p>Complex conjugate of complex field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.curl" title="discretisedfield.Field.curl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">curl</span></code></a></p></td>
<td><p>Curl.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.div" title="discretisedfield.Field.div"><code class="xref py py-obj docutils literal notranslate"><span class="pre">div</span></code></a></p></td>
<td><p>Compute the divergence of a field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.grad" title="discretisedfield.Field.grad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grad</span></code></a></p></td>
<td><p>Gradient.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.hv" title="discretisedfield.Field.hv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hv</span></code></a></p></td>
<td><p>Plot interface, Holoviews/hvplot based.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.imag" title="discretisedfield.Field.imag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">imag</span></code></a></p></td>
<td><p>Imaginary part of complex field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.k3d" title="discretisedfield.Field.k3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">k3d</span></code></a></p></td>
<td><p>Plot interface, k3d based.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.laplace" title="discretisedfield.Field.laplace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">laplace</span></code></a></p></td>
<td><p>Laplace operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.mesh" title="discretisedfield.Field.mesh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mesh</span></code></a></p></td>
<td><p>The mesh on which the field is defined.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.mpl" title="discretisedfield.Field.mpl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mpl</span></code></a></p></td>
<td><p>Plot interface, matplotlib based.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.norm" title="discretisedfield.Field.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a></p></td>
<td><p>Norm of the field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.nvdim" title="discretisedfield.Field.nvdim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nvdim</span></code></a></p></td>
<td><p>Number of value dimensions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.orientation" title="discretisedfield.Field.orientation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orientation</span></code></a></p></td>
<td><p>Orientation field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.phase" title="discretisedfield.Field.phase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">phase</span></code></a></p></td>
<td><p>Phase of complex field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.real" title="discretisedfield.Field.real"><code class="xref py py-obj docutils literal notranslate"><span class="pre">real</span></code></a></p></td>
<td><p>Real part of complex field.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.unit" title="discretisedfield.Field.unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unit</span></code></a></p></td>
<td><p>Unit of the field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.valid" title="discretisedfield.Field.valid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">valid</span></code></a></p></td>
<td><p>Valid field values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#discretisedfield.Field.vdim_mapping" title="discretisedfield.Field.vdim_mapping"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vdim_mapping</span></code></a></p></td>
<td><p>Map vdims to dims.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#discretisedfield.Field.vdims" title="discretisedfield.Field.vdims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vdims</span></code></a></p></td>
<td><p>Vector components of the field.</p></td>
</tr>
</tbody>
</table>
<hr><dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__abs__">
<span class="sig-name descname"><span class="pre">__abs__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__abs__" title="Link to this definition">#</a></dt>
<dd><p>Absolute value of the field.</p>
<p>This is a convenience operator and it returns
absolute value of the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Absolute value of the field.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Computing the absolute value of a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([5.])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.norm" title="discretisedfield.Field.norm"><code class="xref py py-func docutils literal notranslate"><span class="pre">norm()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__add__" title="Link to this definition">#</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p>
<p>It can be applied between two <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects or
between a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object and a “constant”. For
instance if the field is a scalar field, a scalar field or
<code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> can be the second operand. Similarly, for a vector
field, either vector field or an iterable, such as <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>,
or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, can be the second operand. If the second operand
is a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object, both must be defined on the
same mesh and have the same dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>numbers.Real</em><em>, </em><em>tuple</em><em>, </em><em>list</em><em>, </em><em>np.ndarray</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Add vector fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">==</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1., 1., 0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f1</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([5. , 4. , 1.9])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__sub__" title="discretisedfield.Field.__sub__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__sub__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__array_ufunc__">
<span class="sig-name descname"><span class="pre">__array_ufunc__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ufunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__array_ufunc__" title="Link to this definition">#</a></dt>
<dd><p>Field class support for numpy <code class="docutils literal notranslate"><span class="pre">ufuncs</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__call__" title="Link to this definition">#</a></dt>
<dd><p>Sample the field value at <code class="docutils literal notranslate"><span class="pre">point</span></code>.</p>
<p>It returns the value of the field in the discretisation cell to which
<code class="docutils literal notranslate"><span class="pre">point</span></code> belongs to. It returns a tuple, whose length is the same as
the dimension (<code class="docutils literal notranslate"><span class="pre">nvdim</span></code>) of the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>point</strong> (<em>array_like</em>) – For example, in three dimensions, the mesh point coordinate
<span class="math notranslate nohighlight">\(\mathbf{p} = (p_{x}, p_{y}, p_{z})\)</span>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple, whose length is the same as the dimension of the field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Sampling the field value.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
<span class="go">array([1., 3., 4.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__dir__">
<span class="sig-name descname"><span class="pre">__dir__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__dir__" title="Link to this definition">#</a></dt>
<dd><p>Extension of the <code class="docutils literal notranslate"><span class="pre">dir(self)</span></code> list.</p>
<p>Adds component labels to the <code class="docutils literal notranslate"><span class="pre">dir(self)</span></code> list. Similarly, adds or
removes methods (<code class="docutils literal notranslate"><span class="pre">grad</span></code>, <code class="docutils literal notranslate"><span class="pre">div</span></code>,…) depending on the dimension of
the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Avalilable attributes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__eq__" title="Link to this definition">#</a></dt>
<dd><p>Relational operator <code class="docutils literal notranslate"><span class="pre">==</span></code>.</p>
<p>Two fields are considered to be equal if:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>They are defined on the same mesh.</p></li>
<li><p>They have the same number of value dimensions (<code class="docutils literal notranslate"><span class="pre">nvdim</span></code>).</p></li>
<li><p>They both contain the same values in <code class="docutils literal notranslate"><span class="pre">array</span></code>.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a>) – Second operand.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if two fields are equal, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Check if two fields are (not) equal.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">==</span> <span class="n">f2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">!=</span> <span class="n">f2</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">==</span> <span class="n">f3</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">!=</span> <span class="n">f3</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">==</span> <span class="n">f3</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">==</span> <span class="s1">&#39;a&#39;</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__getattr__">
<span class="sig-name descname"><span class="pre">__getattr__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__getattr__" title="Link to this definition">#</a></dt>
<dd><p>Extract the component of the vector field.</p>
<p>This method provides access to individual field components for fields
with dimension &gt; 1. Component labels are defined in the <code class="docutils literal notranslate"><span class="pre">vdims</span></code>
attribute. For dimension 2 and 3 default values <code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, and
<code class="docutils literal notranslate"><span class="pre">'z'</span></code> are used if no custom component labels are provided. For fields
with <code class="docutils literal notranslate"><span class="pre">nvdim&gt;3</span></code> vdims must be specified manually to get
access to individual vector components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>attr</strong> (<em>str</em>) – Vector field component defined in <code class="docutils literal notranslate"><span class="pre">vdims</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar field with vector field component values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Accessing the default vector field vdims.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">x</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">y</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">z</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">nvdim</span>
<span class="go">1</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Accessing custom vector field vdims.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">vdims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mx&#39;</span><span class="p">,</span> <span class="s1">&#39;my&#39;</span><span class="p">,</span> <span class="s1">&#39;mz&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mx</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mx</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">my</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">my</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mz</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mz</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mz</span><span class="o">.</span><span class="n">nvdim</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__getitem__" title="Link to this definition">#</a></dt>
<dd><p>Extracts the field on a subregion.</p>
<p>If subregions were defined by passing <code class="docutils literal notranslate"><span class="pre">subregions</span></code> dictionary when
the mesh was created, this method returns a field in a subregion
<code class="docutils literal notranslate"><span class="pre">subregions[item]</span></code>. Alternatively, a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Region</span></code>
object can be passed and a minimum-sized field containing it will be
returned. The resulting mesh has the same discretisation cell as the
original field’s mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<em>str</em><em>, </em><a class="reference internal" href="discretisedfield.Region.html#discretisedfield.Region" title="discretisedfield.Region"><em>discretisedfield.Region</em></a>) – The key of a subregion in <code class="docutils literal notranslate"><span class="pre">subregions</span></code> dictionary or a region
object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Field on a subregion.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>disretisedfield.Field</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Extract field on the subregion by passing a key.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subregions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;r1&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)),</span>
<span class="gp">... </span>              <span class="s1">&#39;r2&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">subregions</span><span class="o">=</span><span class="n">subregions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;r1&#39;</span><span class="p">]</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;r1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1., 2., 3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([-1., -2., -3.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Extracting a subfield by passing a region.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">50e-9</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e-9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">50e-9</span><span class="p">,</span> <span class="mf">25e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">region</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subregion</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">9e-9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mf">9e-9</span><span class="p">,</span> <span class="mf">14e-9</span><span class="p">,</span> <span class="mf">4e-9</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subfield</span> <span class="o">=</span> <span class="n">field</span><span class="p">[</span><span class="n">subregion</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subfield</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 4, 1, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__iter__">
<span class="sig-name descname"><span class="pre">__iter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__iter__" title="Link to this definition">#</a></dt>
<dd><p>Generator yielding field values of all discretisation cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>np.ndarray</em> – The field value in one discretisation cell.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Iterating through the field values</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="go">[0. 0. 1.]</span>
<span class="go">[0. 0. 1.]</span>
<span class="go">[0. 0. 1.]</span>
<span class="go">[0. 0. 1.]</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Iterating through the mesh coordinates and field values</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="n">field</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="go">[0.5 0.5 0.5] [0. 0. 1.]</span>
<span class="go">[1.5 0.5 0.5] [0. 0. 1.]</span>
<span class="go">[0.5 1.5 0.5] [0. 0. 1.]</span>
<span class="go">[1.5 1.5 0.5] [0. 0. 1.]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.__iter__" title="discretisedfield.Mesh.__iter__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__iter__()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.indices" title="discretisedfield.Mesh.indices"><code class="xref py py-func docutils literal notranslate"><span class="pre">indices()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__lshift__">
<span class="sig-name descname"><span class="pre">__lshift__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__lshift__" title="Link to this definition">#</a></dt>
<dd><p>Stacks multiple scalar fields in a single vector field.</p>
<p>This method takes a list of scalar (<code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>) fields and returns a
vector field, whose components are defined by the scalar fields passed.
If any of the fields passed has <code class="docutils literal notranslate"><span class="pre">nvdim!=1</span></code> or they are not defined on
the same mesh, an exception is raised. The dimension of the resulting
field is equal to the length of the passed list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fields</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects, each with <code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>disrectisedfield.Field</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the dimension of any of the fields is not 1, or the fields
    passed are not defined on the same mesh.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Stack 3 scalar fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">&lt;&lt;</span> <span class="n">f2</span> <span class="o">&lt;&lt;</span> <span class="n">f3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([ 1.,  5., -3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">nvdim</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">f1</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">f2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">z</span> <span class="o">==</span> <span class="n">f3</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__mul__">
<span class="sig-name descname"><span class="pre">__mul__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__mul__" title="Link to this definition">#</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">*</span></code> operator.</p>
<p>It can be applied between:</p>
<ol class="arabic simple">
<li><p>Two fields with equal vector dimensions <code class="docutils literal notranslate"><span class="pre">nvdim</span></code>,</p></li>
<li><p>A field of any dimension <code class="docutils literal notranslate"><span class="pre">nvdim</span></code> and <code class="docutils literal notranslate"><span class="pre">numbers.Complex</span></code>,</p></li>
<li><p>A field of any dimension <code class="docutils literal notranslate"><span class="pre">nvdim</span></code> and a scalar (<code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>) field.</p></li>
</ol>
<p>If both operands are <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects, they must be
defined on the same mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>numbers.Real</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Multiply two scalar fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">f2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([45.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">==</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">f1</span>
<span class="go">True</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Multiply vector field with a scalar.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">*</span> <span class="mi">5</span>  <span class="c1"># discretisedfield.Field.__mul__ is called</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([ 0., 10., 25.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">f1</span>  <span class="c1"># discretisedfield.Field.__rmul__ is called</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([ 0., 20., 50.])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__truediv__" title="discretisedfield.Field.__truediv__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__truediv__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__neg__">
<span class="sig-name descname"><span class="pre">__neg__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__neg__" title="Link to this definition">#</a></dt>
<dd><p>Unary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator.</p>
<p>This method negates the value of each discretisation cell. It is
equivalent to multiplication with -1:</p>
<div class="math notranslate nohighlight">
\[-f(x, y, z) = -1 \cdot f(x, y, z)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Field multiplied with -1.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Applying unary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator on a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-9</span><span class="p">,</span> <span class="mf">3e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">3.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([-3.1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">==</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Applying unary negation operator on a vector field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([   0., 1000.,    3.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__pos__">
<span class="sig-name descname"><span class="pre">__pos__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__pos__" title="Link to this definition">#</a></dt>
<dd><p>Unary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator.</p>
<p>This method defines the unary operator <code class="docutils literal notranslate"><span class="pre">+</span></code>. It returns the field
itself:</p>
<div class="math notranslate nohighlight">
\[+f(x, y, z) = f(x, y, z)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Field itself.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Applying unary <code class="docutils literal notranslate"><span class="pre">+</span></code> operator on a field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="o">+</span><span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([    0., -1000.,    -3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">+</span><span class="p">(</span><span class="o">+</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__pow__">
<span class="sig-name descname"><span class="pre">__pow__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__pow__" title="Link to this definition">#</a></dt>
<dd><p>Unary <code class="docutils literal notranslate"><span class="pre">**</span></code> operator.</p>
<p>This method defines the <code class="docutils literal notranslate"><span class="pre">**</span></code> operator for scalar (<code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>) fields
only. This operator is not defined for vector (<code class="docutils literal notranslate"><span class="pre">nvdim&gt;1</span></code>) fields, and
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>numbers.Real</em>) – Value to which the field is raised.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Applying unary <code class="docutils literal notranslate"><span class="pre">**</span></code> operator on a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">25e-3</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e-3</span><span class="p">,</span> <span class="o">-</span><span class="mf">25e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">25e-3</span><span class="p">,</span> <span class="mf">25e-3</span><span class="p">,</span> <span class="mf">25e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0.5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([4.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f</span><span class="o">**</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([4.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Attempt to apply power operator on a vector field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 1., 9.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__repr__" title="Link to this definition">#</a></dt>
<dd><p>Representation string.</p>
<p>Internally <cite>self._repr_html_()</cite> is called and all html tags are removed
from this string.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Representation string.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Getting representation string.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__sub__">
<span class="sig-name descname"><span class="pre">__sub__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__sub__" title="Link to this definition">#</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">-</span></code> operator.</p>
<p>It can be applied between two <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects or
between a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object and a “constant”. For
instance if the field is a scalar field, a scalar field or
<code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> can be the second operand. Similarly, for a vector
field, either vector field or an iterable, such as <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>,
or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, can be the second operand. If the second operand
is a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object, both must be defined on the
same mesh and have the same dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>numbers.Real</em><em>, </em><em>tuple</em><em>, </em><em>list</em><em>, </em><em>np.ndarray</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Subtract vector fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">-</span> <span class="n">f2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">-</span> <span class="n">f2</span> <span class="o">==</span> <span class="o">-</span><span class="p">(</span><span class="n">f2</span> <span class="o">-</span> <span class="n">f1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 6.])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__add__" title="discretisedfield.Field.__add__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__add__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.__truediv__">
<span class="sig-name descname"><span class="pre">__truediv__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.__truediv__" title="Link to this definition">#</a></dt>
<dd><p>Binary <code class="docutils literal notranslate"><span class="pre">/</span></code> operator.</p>
<p>It can be applied between:</p>
<ol class="arabic simple">
<li><p>Two fields with equal vector dimensions <code class="docutils literal notranslate"><span class="pre">nvdim</span></code>,</p></li>
<li><p>A field of any dimension <code class="docutils literal notranslate"><span class="pre">nvdim</span></code> and <code class="docutils literal notranslate"><span class="pre">numbers.Complex</span></code>,</p></li>
<li><p>A field of any dimension <code class="docutils literal notranslate"><span class="pre">nvdim</span></code> and a scalar (<code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>) field.</p></li>
</ol>
<p>If both operands are <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects, they must be
defined on the same mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>numbers.Real</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Divide two scalar fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">/</span> <span class="n">f2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([5.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f1</span> <span class="o">/</span> <span class="n">f2</span><span class="p">)</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">f2</span> <span class="o">/</span> <span class="n">f1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Divide vector field by a scalar.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">f1</span> <span class="o">/</span> <span class="mi">5</span>  <span class="c1"># discretisedfield.Field.__mul__ is called</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 2., 1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">10</span> <span class="o">/</span> <span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># division by a vector is not allowed</span>
<span class="go">array([inf,  1.,  2.])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__mul__" title="discretisedfield.Field.__mul__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__mul__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.allclose">
<span class="sig-name descname"><span class="pre">allclose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.allclose" title="Link to this definition">#</a></dt>
<dd><p>Allclose method.</p>
<p>This method determines whether two fields are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Defined on the same mesh.</p></li>
<li><p>Have the same number of value dimension (<code class="docutils literal notranslate"><span class="pre">nvdim</span></code>).</p></li>
</ol>
<p>3. All values in are within relative (<code class="docutils literal notranslate"><span class="pre">rtol</span></code>) and absolute
(<code class="docutils literal notranslate"><span class="pre">atol</span></code>) tolerances.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a>) – Field to be compared to.</p></li>
<li><p><strong>rtol</strong> (<em>numbers.Real</em>) – Relative tolerance. Defaults to 1e-5.</p></li>
<li><p><strong>atol</strong> (<em>numbers.Real</em>) – Absolute tolerance. Defaults to 1e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if two fields are within tolerance, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If a non field object is passed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Check if two fields are within a tolerance.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">3</span><span class="o">+</span><span class="mf">1e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">3.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f3</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.angle">
<span class="sig-name descname"><span class="pre">angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.angle" title="Link to this definition">#</a></dt>
<dd><p>Angle between two vectors.</p>
<p>It can be applied between two <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> objects.
For a vector field, the second operand can be a vector in the form of
an iterable, such as <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>,
or <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>. If the second operand
is a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object, both must be defined on the
same mesh and have the same dimensions.
This method then returns a scalar field which is an angle
between the component of the vector field and a vector.
The angle is computed in radians and all values are in <span class="math notranslate nohighlight">\((0,
2\pi)\)</span> range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>numbers.Real</em><em>, </em><em>tuple</em><em>, </em><em>list</em><em>, </em><em>np.ndarray</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Angle scalar field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the field is not sliced.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Computing the angle of the field in yz-plane.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">angle</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1.57079633])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.cross">
<span class="sig-name descname"><span class="pre">cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.cross" title="Link to this definition">#</a></dt>
<dd><p>Cross product.</p>
<p>This method computes the cross product between two fields. Both fields
must be three-dimensional (<code class="docutils literal notranslate"><span class="pre">nvdim=3</span></code>) and defined on the same mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a><em>, </em><em>tuple</em><em>, </em><em>list</em><em>, </em><em>numpy.ndarray</em>) – Second operand.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Compute the cross product of two vector fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f1</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">f2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">f1</span><span class="o">.</span><span class="n">cross</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([ 0., -1.,  0.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.diff">
<span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restrict2valid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.diff" title="Link to this definition">#</a></dt>
<dd><p>Directional derivative.</p>
<p>This method computes a directional derivative of the field and returns
a field. The direction in which the derivative is computed is passed
via <code class="docutils literal notranslate"><span class="pre">direction</span></code> argument, which can be any element of <code class="docutils literal notranslate"><span class="pre">region.dims</span></code>.
The order of the computed derivative can be 1 or 2 and it is specified
using argument <code class="docutils literal notranslate"><span class="pre">order</span></code> and it defaults to 1.</p>
<p>This method uses second order accurate finite difference stencils by default
unless the field is defined on a mesh with too few cells in the differential
direction. In this case the first order accurate finite difference stencils
are used at the boundaries and the second order accurate finite difference
stencils are used in the interior.</p>
<p>Directional derivative cannot be computed if less or equal discretisation
cells exists in a specified direction than the order.
In that case, a zero field is returned.</p>
<p>By default, the directional derivative is computed only across contiguous
areas of the field where the field is valid. This behaviour can be
changed to compute the directional derivative across the whole field
by setting <code class="docutils literal notranslate"><span class="pre">restrict2valid</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Computing of the directional derivative depends
strongly on the boundary condition specified. In this method,
only periodic boundary conditions at the edges of the region
are supported. To enable periodic boundary conditions, set <code class="docutils literal notranslate"><span class="pre">mesh.bc</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direction</strong> (<em>str</em>) – The spatial direction in which the derivative is computed.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – The order of the derivative. It can be 1 or 2 and it defaults to 1.</p></li>
<li><p><strong>restrict2valid</strong> (<em>bool</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the directional derivative is computed only across
contiguous areas of the field where the field is valid. If <code class="docutils literal notranslate"><span class="pre">False</span></code>,
the directional derivative is computed across the whole field.
The default value is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Directional derivative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If order <code class="docutils literal notranslate"><span class="pre">n</span></code> higher than 2 is asked for.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>1. Compute the first-order directional derivative of a scalar field in
the y-direction of a spatially varying field. For the field we choose
<span class="math notranslate nohighlight">\(f(x, y, z) = 2x + 3y - 5z\)</span>. Accordingly, we expect the
derivative in the y-direction to be to be a constant scalar field
<span class="math notranslate nohighlight">\(df/dy = 3\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100e-9</span><span class="p">,</span> <span class="mf">100e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">z</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># first-order derivative by default</span>
<span class="go">array([3.])</span>
</pre></div>
</div>
<p>2. Try to compute the second-order directional derivative of the vector
field which has only one discretisation cell in the z-direction. For
the field we choose <span class="math notranslate nohighlight">\(f(x, y, z) = (2x, 3y, -5z)\)</span>. Accordingly, we
expect the directional derivatives to be: <span class="math notranslate nohighlight">\(df/dx = (2, 0, 0)\)</span>,
<span class="math notranslate nohighlight">\(df/dy=(0, 3, 0)\)</span>, <span class="math notranslate nohighlight">\(df/dz = (0, 0, -5)\)</span>. However, because
there is only one discretisation cell in the z-direction, the
derivative cannot be computed and a zero field is returned.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># derivative cannot be calculated</span>
<span class="go">array([0., 0., 0.])</span>
</pre></div>
</div>
<p>3. Compute the second-order directional derivative of a scalar field with
which is only valid below x=5.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">valid_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">5</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">,</span> <span class="n">valid</span><span class="o">=</span><span class="n">valid_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="go">[[1.0], [1.0], [1.0], [1.0], [1.0], [0.0], [0.0], [0.0], [0.0], [0.0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.dot">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.dot" title="Link to this definition">#</a></dt>
<dd><p>Dot product.</p>
<p>This method computes the dot product between two fields. Both fields
must have the same number of vector dimentions and defined on the same mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field"><em>discretisedfield.Field</em></a>) – Second operand.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong><strong>, </strong><strong>TypeError</strong> – If the operator cannot be applied.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Compute the dot product of two vector fields.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([5.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.fftn">
<span class="sig-name descname"><span class="pre">fftn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.fftn" title="Link to this definition">#</a></dt>
<dd><p>Performs an N-dimensional discrete Fast Fourier Transform (FFT)
on the field.</p>
<p>This method applies an FFT to the field and the underying mesh, transforming
it from a spatial domain into a frequency domain. During this process, any
information about subregions within the field is lost.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Keyword arguments passed directly to the FFT function provided by
SciPy’s fftpack <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.fftn()</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A field representing the Fourier transform of the original field.
This returned field has value dimensions labeled with frequency
(<code class="docutils literal notranslate"><span class="pre">ft_</span></code> in front of each vdim) and values corresponding to frequencies
in the frequency domain.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>1. Create a mesh and perform an FFT.
&gt;&gt;&gt; import discretisedfield as df
&gt;&gt;&gt; mesh = df.Mesh(p1=0, p2=10, cell=2)
&gt;&gt;&gt; field = df.Field(mesh, nvdim=3, value=(1, 2, 3))
&gt;&gt;&gt; fft_field = field.fftn()
&gt;&gt;&gt; fft_field.nvdim
3
&gt;&gt;&gt; fft_field.vdims
[‘ft_x’, ‘ft_y’, ‘ft_z’]</p>
<p>2. Create a 3D mesh and perform an FFT.
&gt;&gt;&gt; import discretisedfield as df
&gt;&gt;&gt; mesh = df.Mesh(p1=(0, 0, 0), p2=(10, 10, 10), cell=(2, 2, 2))
&gt;&gt;&gt; field = df.Field(mesh, nvdim=4, value=(1, 2, 3, 4))
&gt;&gt;&gt; fft_field = field.fftn()
&gt;&gt;&gt; fft_field.nvdim
4
&gt;&gt;&gt; fft_field.vdims
[‘ft_v0’, ‘ft_v1’, ‘ft_v2’, ‘ft_v3’]</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.ifftn" title="discretisedfield.Field.ifftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ifftn()</span></code></a>, <a class="reference internal" href="#discretisedfield.Field.rfftn" title="discretisedfield.Field.rfftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">rfftn()</span></code></a>, <a class="reference internal" href="#discretisedfield.Field.irfftn" title="discretisedfield.Field.irfftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">irfftn()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.fftn" title="discretisedfield.Mesh.fftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">fftn()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.ifftn" title="discretisedfield.Mesh.ifftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ifftn()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.from_xarray">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_xarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xa</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.from_xarray" title="Link to this definition">#</a></dt>
<dd><p>Create <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> from <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></p>
<p>The class method accepts an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> as an argument to
return a <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> object. The first n (or n-1) dimensions of
the DataArray are considered geometric dimensions of a scalar (or vector) field.
In case of a vector field, the last dimension must be named <code class="docutils literal notranslate"><span class="pre">vdims</span></code>. The
DataArray attribute <code class="docutils literal notranslate"><span class="pre">nvdim</span></code> determines whether it is a scalar or a vector
field (i.e. <code class="docutils literal notranslate"><span class="pre">nvdim</span> <span class="pre">=</span> <span class="pre">1</span></code> is a scalar field and <code class="docutils literal notranslate"><span class="pre">nvdim</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code> is a vector
field). Hence, <code class="docutils literal notranslate"><span class="pre">nvdim</span></code> attribute must be present, greater than or equal to
one, and of an integer type.</p>
<p>The DataArray coordinates corresponding to the geometric dimensions represent
the discretisation along the respective dimension and must have equally spaced
values. The coordinates of <code class="docutils literal notranslate"><span class="pre">vdims</span></code> represent the name of field components
(e.g. [‘x’, ‘y’, ‘z’] for a 3D vector field).</p>
<p>Additionally, it is expected to have <code class="docutils literal notranslate"><span class="pre">cell</span></code>, <code class="docutils literal notranslate"><span class="pre">p1</span></code>, and <code class="docutils literal notranslate"><span class="pre">p2</span></code> attributes for
creating the right mesh for the field; however, in the absence of these, the
coordinates of the geometric axes dimensions are utilized. It should be noted
that <code class="docutils literal notranslate"><span class="pre">cell</span></code> attribute is required if any of the geometric directions has only
a single cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xa</strong> (<em>xarray.DataArray</em>) – DataArray to create Field.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Field created from DataArray.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – <ul>
<li><p>If argument is not <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>.
    - If <code class="docutils literal notranslate"><span class="pre">nvdim</span></code> attribute in not an integer.</p></li>
</ul>
</p></li>
<li><p><strong>KeyError</strong> – <ul>
<li><p>If at least one of the geometric dimension coordinates has a single
      value and <code class="docutils literal notranslate"><span class="pre">cell</span></code> attribute is missing.
    - If <code class="docutils literal notranslate"><span class="pre">nvdim</span></code> attribute is absent.</p></li>
</ul>
</p></li>
<li><p><strong>ValueError</strong> – <ul>
<li><p>If DataArray does not have a dimension <code class="docutils literal notranslate"><span class="pre">vdims</span></code> when attribute <code class="docutils literal notranslate"><span class="pre">nvdim</span></code>
      is grater than one.
    - If coordinates of geometrical dimensions are not equally spaced.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Create a DataArray</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xa</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;vdims&#39;</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="n">coords</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
<span class="gp">... </span>                                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
<span class="gp">... </span>                                <span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
<span class="gp">... </span>                                <span class="n">vdims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]),</span>
<span class="gp">... </span>                  <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;mag&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">attrs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cell</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">p1</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">p2</span><span class="o">=</span><span class="p">[</span><span class="mf">21.</span><span class="p">,</span> <span class="mf">21.</span><span class="p">,</span> <span class="mf">21.</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xa</span>
<span class="go">&lt;xarray.DataArray &#39;mag&#39; (x: 20, y: 20, z: 20, vdims: 3)&gt;</span>
<span class="go">...</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Create Field from DataArray</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="o">.</span><span class="n">from_xarray</span><span class="p">(</span><span class="n">xa</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1., 1., 1.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.ifftn">
<span class="sig-name descname"><span class="pre">ifftn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.ifftn" title="Link to this definition">#</a></dt>
<dd><p>Performs an N-dimensional discrete inverse Fast Fourier Transform (iFFT)
on the field.</p>
<p>This method applies an iFFT to the field and the underying mesh, transforming
it from a frequency domain into a spatial domain. During this process, any
information about subregions within the field is lost.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Keyword arguments passed directly to the iFFT function provided by
SciPy’s fftpack <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.ifftn()</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A field representing the inverse Fourier transform of the original field.
This returned field is in the spatial domain and has value dimensions
labeled with the <code class="docutils literal notranslate"><span class="pre">ft_</span></code> removed if the vdims of the original field
started with <code class="docutils literal notranslate"><span class="pre">ft_</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>1. Create a mesh and perform an iFFT.
&gt;&gt;&gt; import discretisedfield as df
&gt;&gt;&gt; mesh = df.Mesh(p1=0, p2=10, cell=2)
&gt;&gt;&gt; field = df.Field(mesh, nvdim=3, value=(1, 2, 3))
&gt;&gt;&gt; ifft_field = field.fftn().ifftn()
&gt;&gt;&gt; ifft_field.nvdim
3
&gt;&gt;&gt; ifft_field.vdims
[‘x’, ‘y’, ‘z’]</p>
<p>2. Create a 3D mesh and perform an iFFT.
&gt;&gt;&gt; import discretisedfield as df
&gt;&gt;&gt; mesh = df.Mesh(p1=(0, 0, 0), p2=(10, 10, 10), cell=(2, 2, 2))
&gt;&gt;&gt; field = df.Field(mesh, nvdim=4, value=(1, 2, 3, 4))
&gt;&gt;&gt; fft_field = field.fftn().ifftn()
&gt;&gt;&gt; fft_field.nvdim
4
&gt;&gt;&gt; fft_field.vdims
[‘v0’, ‘v1’, ‘v2’, ‘v3’]</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.fftn" title="discretisedfield.Field.fftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">fftn()</span></code></a>, <a class="reference internal" href="#discretisedfield.Field.rfftn" title="discretisedfield.Field.rfftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">rfftn()</span></code></a>, <a class="reference internal" href="#discretisedfield.Field.irfftn" title="discretisedfield.Field.irfftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">irfftn()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.fftn" title="discretisedfield.Mesh.fftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">fftn()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.ifftn" title="discretisedfield.Mesh.ifftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ifftn()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.integrate">
<span class="sig-name descname"><span class="pre">integrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.integrate" title="Link to this definition">#</a></dt>
<dd><p>Integral.</p>
<p>This method integrates the field over the mesh along the specified direction,
which can be specified using <code class="docutils literal notranslate"><span class="pre">direction</span></code>. The field is internally multiplied
with the cell size in that direction. If no direction is specified the integral
is computed along all directions.</p>
<p>To compute surface integrals, e.g. flux, the field must be multiplied with the
surface normal vector prior to integration (see example 4).</p>
<p>A cumulative integral can be computed by passing <code class="docutils literal notranslate"><span class="pre">cumulative=True</span></code> and by
specifying a single direction. It resembles the following integral (here as an
example in the x direction):</p>
<div class="math notranslate nohighlight">
\[F(x, y, z) = \int_{p_\mathrm{min}}^x f(x', y, z) \mathrm{d}x\]</div>
<p>The method sums all cells up to (excluding) the cell that contains the point x.
The cell containing x is added with a weight 1/2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direction</strong> (<em>str</em><em>, </em><em>optional</em>) – Direction along which the field is integrated. The direction must be in
<code class="docutils literal notranslate"><span class="pre">field.mesh.region.dims</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>cumulative</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, an cumulative integral is computed. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Integration result. If the field is integrated in all directions, an
<code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a> or np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">cumulative=True</span></code> and no integration direction is specified.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Volume integral of a scalar field.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_\mathrm{V} f(\mathbf{r}) \mathrm{d}V\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">integrate</span><span class="p">()</span>
<span class="go">array([5000.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Volume integral of a vector field.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_\mathrm{V} \mathbf{f}(\mathbf{r}) \mathrm{d}V\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">integrate</span><span class="p">()</span>
<span class="go">array([-1000., -2000., -3000.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Surface integral of a scalar field.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_\mathrm{S} f(\mathbf{r}) |\mathrm{d}\mathbf{S}|\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span><span class="o">.</span><span class="n">integrate</span><span class="p">()</span>
<span class="go">array([500.])</span>
</pre></div>
</div>
<p>4. Surface integral of a vector field (flux). The dot product with the surface
normal vector must be calculated manually.</p>
<div class="math notranslate nohighlight">
\[\int_\mathrm{S} \mathbf{f}(\mathbf{r}) \cdot \mathrm{d}\mathbf{S}\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e_z</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">e_z</span><span class="p">)</span><span class="o">.</span><span class="n">integrate</span><span class="p">()</span>
<span class="go">array([300.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Integral along x-direction.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_{x_\mathrm{min}}^{x_\mathrm{max}} \mathbf{f}(\mathbf{r}) \mathrm{d}x\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([10., 20., 30.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Cumulative integral along x-direction.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_{x_\mathrm{min}}^{x} \mathbf{f}(\mathbf{r}) \mathrm{d}x'\]</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_plane</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Field(...)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.irfftn">
<span class="sig-name descname"><span class="pre">irfftn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.irfftn" title="Link to this definition">#</a></dt>
<dd><p>Performs an N-dimensional discrete inverse real Fast Fourier Transform
(irFFT) on the field.</p>
<p>This method applies an irFFT to the field and the underying mesh, transforming
it from a frequency domain into a spatial domain. During this process, any
information about subregions within the field is lost.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Keyword arguments passed directly to the irFFT function provided by
SciPy’s fftpack <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.irfftn()</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A field representing the inverse Fourier transform of the original field.
This returned field is in the spatial domain and has value dimensions
labeled with the <code class="docutils literal notranslate"><span class="pre">ft_</span></code> removed if the vdims of the original field
started with <code class="docutils literal notranslate"><span class="pre">ft_</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>1. Create a mesh and perform an irFFT.
&gt;&gt;&gt; import discretisedfield as df
&gt;&gt;&gt; mesh = df.Mesh(p1=0, p2=10, cell=2)
&gt;&gt;&gt; field = df.Field(mesh, nvdim=3, value=(1, 2, 3))
&gt;&gt;&gt; ifft_field = field.fftn().irfftn()
&gt;&gt;&gt; ifft_field.nvdim
3
&gt;&gt;&gt; ifft_field.vdims
[‘x’, ‘y’, ‘z’]</p>
<p>2. Create a 3D mesh and perform an irFFT.
&gt;&gt;&gt; import discretisedfield as df
&gt;&gt;&gt; mesh = df.Mesh(p1=(0, 0, 0), p2=(10, 10, 10), cell=(2, 2, 2))
&gt;&gt;&gt; field = df.Field(mesh, nvdim=4, value=(1, 2, 3, 4))
&gt;&gt;&gt; fft_field = field.fftn().irfftn()
&gt;&gt;&gt; fft_field.nvdim
4
&gt;&gt;&gt; fft_field.vdims
[‘v0’, ‘v1’, ‘v2’, ‘v3’]</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.fftn" title="discretisedfield.Field.fftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">fftn()</span></code></a>, <a class="reference internal" href="#discretisedfield.Field.ifftn" title="discretisedfield.Field.ifftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ifftn()</span></code></a>, <a class="reference internal" href="#discretisedfield.Field.rfftn" title="discretisedfield.Field.rfftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">rfftn()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.fftn" title="discretisedfield.Mesh.fftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">fftn()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.ifftn" title="discretisedfield.Mesh.ifftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ifftn()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.line">
<span class="sig-name descname"><span class="pre">line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.line" title="Link to this definition">#</a></dt>
<dd><p>Sample the field along the line.</p>
<p>Given two points <span class="math notranslate nohighlight">\(p_{1}\)</span> and <span class="math notranslate nohighlight">\(p_{2}\)</span>, <span class="math notranslate nohighlight">\(n\)</span> position
coordinates are generated and the corresponding field values.</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_{i} = i\frac{\mathbf{p}_{2} -
\mathbf{p}_{1}}{n-1}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p1</strong> (<em>array_like</em>) – Two points between which the line is generated.</p></li>
<li><p><strong>p2</strong> (<em>array_like</em>) – Two points between which the line is generated.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of points on the line. Defaults to 100.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Line object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="discretisedfield.Line.html#discretisedfield.Line" title="discretisedfield.Line">discretisedfield.Line</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">p1</span></code> or <code class="docutils literal notranslate"><span class="pre">p2</span></code> is outside the mesh domain.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Sampling the field along the line.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.mean" title="Link to this definition">#</a></dt>
<dd><p>Field mean.</p>
<p>It computes the arithmetic mean along the specified direction of the field.</p>
<p>It returns a numpy array containing the mean value if all the geometrical
directions or none are selected. If one or more than one directions (and less
than <code class="docutils literal notranslate"><span class="pre">region.dims</span></code>) are selected, the method returns a field of appropriate
geometric dimensions with the calculated mean value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>direction</strong> (<em>None</em><em>, </em><em>string</em><em> or </em><em>tuple</em><em> of </em><em>strings</em><em>, </em><em>optional.</em>) – Directions along which
the mean is computed. The default is to
compute the mean of the entire volume and return an array of the
averaged vector components.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy.ndarray</em> – Field average along all the geometrical directions combined.</p></li>
<li><p><em>discretisedfield.Field</em> – Field of reduced geometrical dimensions holding the mean value along the
selected direction(s).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Computing the vector field average.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 1.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Computing the scalar field average.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">55</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([55.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Computing the vector field mean along x direction.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="go">array([0., 0., 1.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Computing the vector field mean along x and y directions.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">array([0., 0., 1.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.pad">
<span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pad_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.pad" title="Link to this definition">#</a></dt>
<dd><p>Field padding.</p>
<p>This method pads the field by adding more cells in chosen direction and
assigning to them the values as specified by the <code class="docutils literal notranslate"><span class="pre">mode</span></code> argument.
The way in which the field is going to padded is defined by passing
<code class="docutils literal notranslate"><span class="pre">pad_width</span></code> dictionary. The keys of the dictionary are the directions
(axes), e.g. <code class="docutils literal notranslate"><span class="pre">'x'</span></code>, <code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>, whereas the values are the
tuples of length 2. The first integer in the tuple is the number of
cells added in the negative direction, and the second integer is the
number of cells added in the positive direction.</p>
<p>This method accepts any other arguments allowed by <code class="docutils literal notranslate"><span class="pre">numpy.pad</span></code>
function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pad_width</strong> (<em>dict</em>) – The keys of the dictionary are the directions (axes), e.g. <code class="docutils literal notranslate"><span class="pre">'x'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'y'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'z'</span></code>, whereas the values are the tuples of length 2.
The first integer in the tuple is the number of cells added in the
negative direction, and the second integer is the number of cells
added in the positive direction.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – Padding mode as defined in <code class="docutils literal notranslate"><span class="pre">numpy.pad</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Padded field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Padding a field in the x direction by 1 cell with <code class="docutils literal notranslate"><span class="pre">constant</span></code> mode.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Two cells with value 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">pad</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)},</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>  <span class="c1"># zeros padded</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0.5])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.resample">
<span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.resample" title="Link to this definition">#</a></dt>
<dd><p>Resample field.</p>
<p>This method computes the field on a new mesh with <code class="docutils literal notranslate"><span class="pre">n</span></code> cells. The boundaries
<code class="docutils literal notranslate"><span class="pre">pmin</span></code> and <code class="docutils literal notranslate"><span class="pre">pmax</span></code> stay unchanged. The values of the new cells are taken from
the nearest old cell, no interpolation is performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<em>array_like</em>) – Number of cells in each direction. The number of elements must match
field.mesh.region.ndim.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resampled field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Decrease the number of cells.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">n</span>
<span class="go">array([10, 10, 10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">down_sampled</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">resample</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">down_sampled</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">n</span>
<span class="go">array([5, 5, 5])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Increase the number of cells.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">n</span>
<span class="go">array([10, 10, 10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">up_sampled</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">resample</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">up_sampled</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">n</span>
<span class="go">array([10, 15, 20])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.rfftn">
<span class="sig-name descname"><span class="pre">rfftn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.rfftn" title="Link to this definition">#</a></dt>
<dd><p>Performs an N-dimensional discrete real Fast Fourier Transform (rFFT)
on the field.</p>
<p>This method applies an rFFT to the field and the underying mesh, transforming
it from a spatial domain into a frequency domain. During this process, any
information about subregions within the field is lost.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – Keyword arguments passed directly to the rFFT function provided by
SciPy’s fftpack <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.fft.rfftn()</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A field representing the Fourier transform of the original field.
This returned field has value dimensions labeled with frequency
(<code class="docutils literal notranslate"><span class="pre">ft_</span></code> in front of each vdim) and values corresponding to frequencies
in the frequency domain.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>1. Create a mesh and perform an rFFT.
&gt;&gt;&gt; import discretisedfield as df
&gt;&gt;&gt; mesh = df.Mesh(p1=0, p2=10, cell=2)
&gt;&gt;&gt; field = df.Field(mesh, nvdim=3, value=(1, 2, 3))
&gt;&gt;&gt; fft_field = field.rfftn()
&gt;&gt;&gt; fft_field.nvdim
3
&gt;&gt;&gt; fft_field.vdims
[‘ft_x’, ‘ft_y’, ‘ft_z’]</p>
<p>2. Create a 3D mesh and perform an rFFT.
&gt;&gt;&gt; import discretisedfield as df
&gt;&gt;&gt; mesh = df.Mesh(p1=(0, 0, 0), p2=(10, 10, 10), cell=(2, 2, 2))
&gt;&gt;&gt; field = df.Field(mesh, nvdim=4, value=(1, 2, 3, 4))
&gt;&gt;&gt; fft_field = field.rfftn()
&gt;&gt;&gt; fft_field.nvdim
4
&gt;&gt;&gt; fft_field.vdims
[‘ft_v0’, ‘ft_v1’, ‘ft_v2’, ‘ft_v3’]</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.fftn" title="discretisedfield.Field.fftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">fftn()</span></code></a>, <a class="reference internal" href="#discretisedfield.Field.ifftn" title="discretisedfield.Field.ifftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ifftn()</span></code></a>, <a class="reference internal" href="#discretisedfield.Field.irfftn" title="discretisedfield.Field.irfftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">irfftn()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.fftn" title="discretisedfield.Mesh.fftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">fftn()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.ifftn" title="discretisedfield.Mesh.ifftn"><code class="xref py py-func docutils literal notranslate"><span class="pre">ifftn()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.rotate90">
<span class="sig-name descname"><span class="pre">rotate90</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.rotate90" title="Link to this definition">#</a></dt>
<dd><p>Rotate field and underlying mesh by 90°.</p>
<p>Rotate the field <code class="docutils literal notranslate"><span class="pre">k</span></code> times by 90 degrees in the plane defined by <code class="docutils literal notranslate"><span class="pre">ax1</span></code> and
<code class="docutils literal notranslate"><span class="pre">ax2</span></code>. The rotation direction is from <code class="docutils literal notranslate"><span class="pre">ax1</span></code> to <code class="docutils literal notranslate"><span class="pre">ax2</span></code>, the two must be
different.</p>
<p>For vector fields (<code class="docutils literal notranslate"><span class="pre">nvdim&gt;1</span></code>) the components of the vector pointing along
<code class="docutils literal notranslate"><span class="pre">ax1</span></code> and <code class="docutils literal notranslate"><span class="pre">ax2</span></code> are determined from <code class="docutils literal notranslate"><span class="pre">vdim_mapping</span></code>. Rotation is only
possible if this mapping defines vector components along both directions <code class="docutils literal notranslate"><span class="pre">ax1</span></code>
and <code class="docutils literal notranslate"><span class="pre">ax2</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax1</strong> (<em>str</em>) – Name of the first dimension.</p></li>
<li><p><strong>ax2</strong> (<em>str</em>) – Name of the second dimension.</p></li>
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of 90° rotations, defaults to 1.</p></li>
<li><p><strong>reference_point</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Point around which the mesh is rotated. If not provided the mesh.region’s
centre point of the field is used.</p></li>
<li><p><strong>inplace</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the rotation is applied in-place. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The rotated field object. Either a new object or a reference to the
existing field for <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If a vector field (<code class="docutils literal notranslate"><span class="pre">nvdim&gt;1</span></code>) does not provide the required mapping
    between spatial directions and vector components in <code class="docutils literal notranslate"><span class="pre">vdim_mapping</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">rotate90</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">pmin</span>
<span class="go">array([ 1., -1.,  0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">pmax</span>
<span class="go">array([9., 9., 6.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">n</span>
<span class="go">array([ 4, 10,  6])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([-2.,  1.,  3.])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="discretisedfield.Region.html#discretisedfield.Region.rotate90" title="discretisedfield.Region.rotate90"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotate90()</span></code></a>, <a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh.rotate90" title="discretisedfield.Mesh.rotate90"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotate90()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.sel">
<span class="sig-name descname"><span class="pre">sel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.sel" title="Link to this definition">#</a></dt>
<dd><p>Select a part of the field.</p>
<p>If one of the axis from <code class="docutils literal notranslate"><span class="pre">region.dims</span></code> is passed as a string, a field of a
reduced dimension along the axis and perpendicular to it is extracted,
intersecting the axis at its center. Alternatively, if a keyword (representing
the axis) argument is passed with a real number value (e.g. <code class="docutils literal notranslate"><span class="pre">x=1e-9</span></code>), a field
of reduced dimensions intersects the axis at a point ‘nearest’ to the provided
value is returned. If the mesh is already 1 dimentional a numpy array of the
field values is returned.</p>
<p>If instead a tuple, list or a numpy array of length 2 is
passed as a value containing two real numbers (e.g. <code class="docutils literal notranslate"><span class="pre">x=(1e-9,</span> <span class="pre">7e-9)</span></code>), a sub
field is returned with minimum and maximum points along the selected axis,
‘nearest’ to the minimum and maximum of the selected values, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – A string corresponding to the selection axis that belongs to
<code class="docutils literal notranslate"><span class="pre">region.dims</span></code>.</p></li>
<li><p><strong>kwarg</strong> – A key corresponding to the selection axis that belongs to <code class="docutils literal notranslate"><span class="pre">region.dims</span></code>.
The values are either a <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> or list, tuple, numpy array of
length 2 containing <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> which represents a point or a range of
points to be selected from the mesh.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An extracted field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a> or numpy.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Extracting the mesh at a specific point (<code class="docutils literal notranslate"><span class="pre">y=1</span></code>).</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plane_field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plane_field</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">ndim</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plane_field</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">dims</span>
<span class="go">(&#39;x&#39;, &#39;z&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plane_field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1., 2., 3.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Extracting the xy-plane mesh at the mesh region center.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plane_field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plane_field</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">ndim</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plane_field</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">dims</span>
<span class="go">(&#39;x&#39;, &#39;y&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plane_field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1., 2., 3.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Specifying a range of points along axis <code class="docutils literal notranslate"><span class="pre">x</span></code> to be selected from mesh.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">selected_field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selected_field</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">ndim</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selected_field</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">dims</span>
<span class="go">(&#39;x&#39;, &#39;y&#39;, &#39;z&#39;)</span>
</pre></div>
</div>
<p>4. Extracting the mesh at a specific point on a 1D mesh.
&gt;&gt;&gt; mesh = df.Mesh(p1=0, p2=5, cell=1)
&gt;&gt;&gt; field = df.Field(mesh, nvdim=3, value=(1, 2, 3))
&gt;&gt;&gt; field.sel(‘x’)
array([1., 2., 3.])</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.to_vtk">
<span class="sig-name descname"><span class="pre">to_vtk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.to_vtk" title="Link to this definition">#</a></dt>
<dd><p>Convert field to vtk rectilinear grid.</p>
<p>This method convers at <cite>discretisedfield.Field</cite> into a
<cite>vtk.vtkRectilinearGrid</cite>. The field data (<code class="docutils literal notranslate"><span class="pre">field.array</span></code>) is stored as
<code class="docutils literal notranslate"><span class="pre">CELL_DATA</span></code> of the <code class="docutils literal notranslate"><span class="pre">RECTILINEAR_GRID</span></code>. Scalar fields (<code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>)
contain one VTK array called <code class="docutils literal notranslate"><span class="pre">field</span></code>. Vector fields (<code class="docutils literal notranslate"><span class="pre">nvdim&gt;1</span></code>)
contain one VTK array called <code class="docutils literal notranslate"><span class="pre">field</span></code> containing vector data and
scalar VTK arrays for each field component (called
<code class="docutils literal notranslate"><span class="pre">&lt;component-name&gt;-component</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>VTK representation of the field.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>vtk.vtkRectilinearGrid</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AttributeError</strong> – If the field has <code class="docutils literal notranslate"><span class="pre">nvdim&gt;1</span></code> and component labels are missing.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_vtk</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">to_vtk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">f_vtk</span><span class="p">)</span>
<span class="go">vtkRectilinearGrid (...)</span>
<span class="go">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_vtk</span><span class="o">.</span><span class="n">GetNumberOfCells</span><span class="p">()</span>
<span class="go">1000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.to_xarray">
<span class="sig-name descname"><span class="pre">to_xarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'field'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.to_xarray" title="Link to this definition">#</a></dt>
<dd><p>Field value as <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>.</p>
<p>The function returns an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> with the dimensions
<code class="docutils literal notranslate"><span class="pre">self.mesh.region.dims</span></code> and <code class="docutils literal notranslate"><span class="pre">vdims</span></code> (only if <code class="docutils literal notranslate"><span class="pre">field.nvdim</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>). The
coordinates of the geometric dimensions are derived from <code class="docutils literal notranslate"><span class="pre">self.mesh.points</span></code>,
and for vector field components from <code class="docutils literal notranslate"><span class="pre">self.vdims</span></code>. Addtionally,
the values of <code class="docutils literal notranslate"><span class="pre">self.mesh.cell</span></code>, <code class="docutils literal notranslate"><span class="pre">self.mesh.region.pmin</span></code>, and
<code class="docutils literal notranslate"><span class="pre">self.mesh.region.pmax</span></code> are stored as <code class="docutils literal notranslate"><span class="pre">cell</span></code>, <code class="docutils literal notranslate"><span class="pre">pmin</span></code>, and <code class="docutils literal notranslate"><span class="pre">pmax</span></code>
attributes of the DataArray. The <code class="docutils literal notranslate"><span class="pre">unit</span></code> attribute of geometric
dimensions is set to the respective strings in <code class="docutils literal notranslate"><span class="pre">self.mesh.region.units</span></code>.</p>
<p>The name and unit of the field <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> can be set by passing
<code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">unit</span></code>. If the type of value passed to any of the two
arguments is not <code class="docutils literal notranslate"><span class="pre">str</span></code>, then a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – String to set name of the field <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>.</p></li>
<li><p><strong>unit</strong> (<em>str</em><em>, </em><em>optional</em>) – String to set units of the field <code class="docutils literal notranslate"><span class="pre">DataArray</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Field values DataArray.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – If either <code class="docutils literal notranslate"><span class="pre">name</span></code> or <code class="docutils literal notranslate"><span class="pre">unit</span></code> argument is not a string.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Create a field</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">norm</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span>
<span class="go">Field(...)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Create <cite>xarray.DataArray</cite> from field</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xa</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xa</span>
<span class="go">&lt;xarray.DataArray &#39;field&#39; (x: 10, y: 10, z: 10, vdims: 3)&gt;</span>
<span class="go">...</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Select values of <cite>x</cite> component</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xa</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">vdims</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">&lt;xarray.DataArray &#39;field&#39; (x: 10, y: 10, z: 10)&gt;</span>
<span class="go">...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="discretisedfield.Field.update_field_values">
<span class="sig-name descname"><span class="pre">update_field_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#discretisedfield.Field.update_field_values" title="Link to this definition">#</a></dt>
<dd><p>Set field value representation.</p>
<p>The value of the field can be set using a scalar value for <code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>
fields (e.g. <code class="docutils literal notranslate"><span class="pre">field.update_field_values(3)</span></code>) or <code class="docutils literal notranslate"><span class="pre">array_like</span></code> value
for <code class="docutils literal notranslate"><span class="pre">nvdim&gt;1</span></code> fields (e.g. <code class="docutils literal notranslate"><span class="pre">field.update_field_values((1,</span> <span class="pre">2,</span> <span class="pre">3))</span></code>).
Alternatively, the value can be defined
using a callable object, which takes a point tuple as an input argument
and returns a value of appropriate dimension. Internally, callable
object is called for every point in the mesh on which the field is
defined. For instance, callable object can be a Python function or
another <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code>. Finally, <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> with
shape <code class="docutils literal notranslate"><span class="pre">(*self.mesh.n,</span> <span class="pre">nvdim)</span></code> can be passed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>numbers.Real</em><em>, </em><em>array_like</em><em>, </em><em>callable</em><em>, </em><em>dict</em>) – <p>For scalar fields (<code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>) <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> values are allowed.
In the case of vector fields, <code class="docutils literal notranslate"><span class="pre">array_like</span></code> (list, tuple,
numpy.ndarray) value with length equal to <cite>nvdim</cite> should be used.
Finally, the value can also be a callable (e.g. Python function or
another field), which for every coordinate in the mesh returns a
valid value. If <code class="docutils literal notranslate"><span class="pre">field.update_field_values(0)</span></code>, all values in the field
will be set to zero independent of the field dimension.</p>
<p>If subregions are defined value can be initialised with a dict.
Allowed keys are names of all subregions and <code class="docutils literal notranslate"><span class="pre">default</span></code>. Items
must be either <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code> for <code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code> or <code class="docutils literal notranslate"><span class="pre">array_like</span></code>
for <code class="docutils literal notranslate"><span class="pre">nvdim=3</span></code>. If subregion names are missing, the value of
<code class="docutils literal notranslate"><span class="pre">default</span></code> is used if given. If parts of the region are not
contained within one subregion <code class="docutils literal notranslate"><span class="pre">default</span></code> is used if specified,
else these values are set to 0.</p>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If unsupported type is passed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Different ways of setting the field value.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>If value is not specified, zero-field is defined</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">update_field_values</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 1.])</span>
</pre></div>
</div>
<p>Setting the field value using a Python function (callable).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_function</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">update_field_values</span><span class="p">(</span><span class="n">value_function</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="go">array([0., 0., 1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="p">((</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="go">array([ 0.,  0., -1.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Field with subregions in mesh</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">p2</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span>                           <span class="n">subregions</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s1&#39;</span><span class="p">:</span> <span class="n">sub1</span><span class="p">,</span> <span class="s1">&#39;s2&#39;</span><span class="p">:</span> <span class="n">sub2</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;s2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s1&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">subregions</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">sub1</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">array</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.array" title="discretisedfield.Field.array"><code class="xref py py-func docutils literal notranslate"><span class="pre">array()</span></code></a></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="discretisedfield.Field.__hash__">
<span class="sig-name descname"><span class="pre">__hash__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#discretisedfield.Field.__hash__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.abs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">abs</span></span><a class="headerlink" href="#discretisedfield.Field.abs" title="Link to this definition">#</a></dt>
<dd><p>Absolute value of complex field.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">array</span></span><a class="headerlink" href="#discretisedfield.Field.array" title="Link to this definition">#</a></dt>
<dd><p>Field value as <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.</p>
<p>The shape of the array is <code class="docutils literal notranslate"><span class="pre">(*mesh.n,</span> <span class="pre">nvdim)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<em>numpy.ndarray</em>) – Array with shape <code class="docutils literal notranslate"><span class="pre">(*mesh.n,</span> <span class="pre">nvdim)</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Field values array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If unsupported type or shape is passed.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Accessing and setting the field array.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">array</span>
<span class="go">array(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 1, 1, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">array</span>
<span class="go">array(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1., 1., 1.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.conjugate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conjugate</span></span><a class="headerlink" href="#discretisedfield.Field.conjugate" title="Link to this definition">#</a></dt>
<dd><p>Complex conjugate of complex field.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.curl">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">curl</span></span><a class="headerlink" href="#discretisedfield.Field.curl" title="Link to this definition">#</a></dt>
<dd><p>Curl.</p>
<p>This method computes the curl of a three dimensional vector (<code class="docutils literal notranslate"><span class="pre">nvdim=3</span></code>)
field in three spatial dimensions (<code class="docutils literal notranslate"><span class="pre">ndim=3</span></code>) and returns
a three dimensional vector (<code class="docutils literal notranslate"><span class="pre">nvdim=3</span></code>) field in three spatial
dimensions (<code class="docutils literal notranslate"><span class="pre">ndim=3</span></code>)</p>
<div class="math notranslate nohighlight">
\[\nabla \times \mathbf{v} = \left(\frac{\partial
v_{2}}{\partial x_{1}} - \frac{\partial v_{1}}{\partial x_{2}},
\frac{\partial v_{0}}{\partial x_{2}} - \frac{\partial
v_{2}}{\partial x_{0}}, \frac{\partial v_{1}}{\partial x_{0}} -
\frac{\partial v_{0}}{\partial x_{1}},\right)\]</div>
<p>Directional derivative cannot be computed if only one discretisation
cell exists in a certain direction. In that case, a zero field is
considered to be that directional derivative. More precisely, it is
assumed that the field does not change in that direction.
<code class="docutils literal notranslate"><span class="pre">vdim_mapping</span></code> needs to be set in order to relate the vector and
spatial dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Curl of the field.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the <code class="docutils literal notranslate"><span class="pre">ndim</span></code> or <code class="docutils literal notranslate"><span class="pre">nvdim</span></code> of the field is not 3.
    The <code class="docutils literal notranslate"><span class="pre">vdims</span></code> are not correctly mapped to the <code class="docutils literal notranslate"><span class="pre">dims</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>1. Compute curl of a vector field. For a field we choose
<span class="math notranslate nohighlight">\(\mathbf{v}(x, y, z) = (2xy, -2y, 5xz)\)</span>. Accordingly, we expect
the curl to be to be a constant vector field <span class="math notranslate nohighlight">\(\nabla\times
\mathbf{v} = (0, -5z, -2x)\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">curl</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">array([ 0., -5., -2.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Attempt to compute the curl of a scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">3.14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">curl</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">derivative()</span></code></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.div">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">div</span></span><a class="headerlink" href="#discretisedfield.Field.div" title="Link to this definition">#</a></dt>
<dd><p>Compute the divergence of a field.</p>
<p>This method calculates the divergence of a field of dimension <cite>nvdim</cite>
and returns a scalar (<code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>) field as a result.</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot\mathbf{v} = \sum_i\frac{\partial v_{i}}
{\partial i}\]</div>
<p>Directional derivative cannot be computed if only one discretisation
cell exists in a certain direction. In that case, a zero field is
considered to be that directional derivative. More precisely, it is
assumed that the field does not change in that direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Resulting field.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the field and the mesh don’t have the same dimentionality or
    they are not mapped correctly.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>1. Compute the divergence of a vector field. For a field we choose
<span class="math notranslate nohighlight">\(\mathbf{v}(x, y, z) = (2x, -2y, 5z)\)</span>. Accordingly, we expect
the divergence to be to be a constant scalar field <span class="math notranslate nohighlight">\(\nabla\cdot
\mathbf{v} = 5\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100e-9</span><span class="p">,</span> <span class="mf">100e-9</span><span class="p">,</span> <span class="mf">100e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([5.])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">derivative()</span></code></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.grad">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grad</span></span><a class="headerlink" href="#discretisedfield.Field.grad" title="Link to this definition">#</a></dt>
<dd><p>Gradient.</p>
<p>This method computes the gradient of a scalar (<code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>) field and
returns a vector field with the same number of dimensions as the space
on which the scalar field is defined (<code class="docutils literal notranslate"><span class="pre">ndim</span></code>):</p>
<div class="math notranslate nohighlight">
\[\nabla f = (\frac{\partial f}{\partial x_1},
            ...
            \frac{\partial f}{\partial x_ndim}\]</div>
<p>Directional derivative cannot be computed if only one discretisation
cell exists in a certain direction. In that case, a zero field is
considered to be that directional derivative. More precisely, it is
assumed that the field does not change in that direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Resulting field.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the dimension of the field is not 1.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Compute gradient of a contant field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>2. Compute gradient of a spatially varying field. For a field we choose
<span class="math notranslate nohighlight">\(f(x, y, z) = 2x + 3y - 5z\)</span>. Accordingly, we expect the gradient
to be a constant vector field <span class="math notranslate nohighlight">\(\nabla f = (2, 3, -5)\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([ 2.,  3., -5.])</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Attempt to compute the gradient of a vector field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">grad</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">derivative()</span></code></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.hv">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hv</span></span><a class="headerlink" href="#discretisedfield.Field.hv" title="Link to this definition">#</a></dt>
<dd><p>Plot interface, Holoviews/hvplot based.</p>
<p>This property provides access to the different plotting methods. It is
also callable to quickly generate plots. For more details and the
available methods refer to the documentation linked below.</p>
<p>Data shown in the plot is automatically filtered using the <cite>valid</cite> property of
the field.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="discretisedfield.plotting.Hv.html#discretisedfield.plotting.Hv.__call__" title="discretisedfield.plotting.Hv.__call__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__call__()</span></code></a>
<a class="reference internal" href="discretisedfield.plotting.Hv.html#discretisedfield.plotting.Hv.scalar" title="discretisedfield.plotting.Hv.scalar"><code class="xref py py-func docutils literal notranslate"><span class="pre">scalar()</span></code></a>
<a class="reference internal" href="discretisedfield.plotting.Hv.html#discretisedfield.plotting.Hv.vector" title="discretisedfield.plotting.Hv.vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">vector()</span></code></a>
<a class="reference internal" href="discretisedfield.plotting.Hv.html#discretisedfield.plotting.Hv.contour" title="discretisedfield.plotting.Hv.contour"><code class="xref py py-func docutils literal notranslate"><span class="pre">contour()</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Visualising the field using <code class="docutils literal notranslate"><span class="pre">hv</span></code>.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">hv</span><span class="p">(</span><span class="n">kdims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="go">:DynamicMap...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.imag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">imag</span></span><a class="headerlink" href="#discretisedfield.Field.imag" title="Link to this definition">#</a></dt>
<dd><p>Imaginary part of complex field.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.k3d">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k3d</span></span><a class="headerlink" href="#discretisedfield.Field.k3d" title="Link to this definition">#</a></dt>
<dd><p>Plot interface, k3d based.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.laplace">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">laplace</span></span><a class="headerlink" href="#discretisedfield.Field.laplace" title="Link to this definition">#</a></dt>
<dd><p>Laplace operator.</p>
<p>This method computes the laplacian for any field:</p>
<div class="math notranslate nohighlight">
\[\nabla^2 f = \sum_{i=0}^\mathrm{ndim}
                    \frac{\partial^{2} f}{\partial x_i^{2}}\]</div>
<div class="math notranslate nohighlight">
\[\nabla^2 \mathbf{f} = (\nabla^2 f_{0},
                         ...
                         \nabla^2 f_mathrm{nvdim})\]</div>
<p>Directional derivative cannot be computed if only one discretisation
cell exists in a certain direction. In that case, a zero field is
considered to be that directional derivative. More precisely, it is
assumed that the field does not change in that direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Laplacian of the field.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<ol class="arabic simple">
<li><p>Compute Laplacian of a contant scalar field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">,</span> <span class="mf">10e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">,</span> <span class="mf">2e-9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">laplace</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0.])</span>
</pre></div>
</div>
<p>2. Compute Laplacian of a spatially varying field. For a field we
choose <span class="math notranslate nohighlight">\(f(x, y, z) = 2x^{2} + 3y - 5z\)</span>. Accordingly, we expect
the Laplacian to be a constant vector field <span class="math notranslate nohighlight">\(\nabla f = (4, 0,
0)\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">value_fun</span><span class="p">(</span><span class="n">point</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">point</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value_fun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">laplace</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-3</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">derivative()</span></code></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.mesh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mesh</span></span><a class="headerlink" href="#discretisedfield.Field.mesh" title="Link to this definition">#</a></dt>
<dd><p>The mesh on which the field is defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The finite-difference rectangular mesh on which the field is defined.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="discretisedfield.Mesh.html#discretisedfield.Mesh" title="discretisedfield.Mesh">discretisedfield.Mesh</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.mpl">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mpl</span></span><a class="headerlink" href="#discretisedfield.Field.mpl" title="Link to this definition">#</a></dt>
<dd><p>Plot interface, matplotlib based.</p>
<p>This property provides access to the different plotting methods. It is
also callable to quickly generate plots. For more details and the
available methods refer to the documentation linked below.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">__call__()</span></code>
<code class="xref py py-func docutils literal notranslate"><span class="pre">scalar()</span></code>
<code class="xref py py-func docutils literal notranslate"><span class="pre">vector()</span></code>
<code class="xref py py-func docutils literal notranslate"><span class="pre">lightness()</span></code>
<code class="xref py py-func docutils literal notranslate"><span class="pre">contour()</span></code></p>
</div>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Visualising the field using <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">mpl</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../../_images/discretisedfield-Field-1.png" class="plot-directive" src="../../_images/discretisedfield-Field-1.png" />
</figure>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.norm">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">norm</span></span><a class="headerlink" href="#discretisedfield.Field.norm" title="Link to this definition">#</a></dt>
<dd><p>Norm of the field.</p>
<p>Computes the norm of the field and returns <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code>
with <code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>. Norm of a scalar field is interpreted as an absolute
value of the field.</p>
<p>The field norm can be set by passing <code class="docutils literal notranslate"><span class="pre">numbers.Real</span></code>,
<code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>, or callable. If the field contains zero values, norm
cannot be set and <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>numbers.Real</strong> – Norm value.</p></li>
<li><p><strong>numpy.ndarray</strong> – Norm value.</p></li>
<li><p><strong>callable</strong> – Norm value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Norm of the field.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the norm is set with wrong type, shape, or value. In addition,
    if the field contains zero values.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Manipulating the field norm.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">),</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([0., 0., 2.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">update_field_values</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1.])</span>
</pre></div>
</div>
<p>Set the norm for a zero field.
&gt;&gt;&gt; field.update_field_values(0)
&gt;&gt;&gt; field.mean()
array([0., 0., 0.])
&gt;&gt;&gt; field.norm = 1
&gt;&gt;&gt; field.mean()
array([0., 0., 0.])</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#discretisedfield.Field.__abs__" title="discretisedfield.Field.__abs__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__abs__()</span></code></a></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.nvdim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nvdim</span></span><a class="headerlink" href="#discretisedfield.Field.nvdim" title="Link to this definition">#</a></dt>
<dd><p>Number of value dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scalar fields have dimension 1, vector fields can have any dimension greater
than 1.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.orientation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orientation</span></span><a class="headerlink" href="#discretisedfield.Field.orientation" title="Link to this definition">#</a></dt>
<dd><p>Orientation field.</p>
<p>This method computes the orientation (direction) of a vector field and
returns <code class="docutils literal notranslate"><span class="pre">discretisedfield.Field</span></code> with the same dimension. More
precisely, at every mesh discretisation cell, the vector is divided by
its norm, so that a unit vector is obtained. However, if the vector at
a discretisation cell is a zero-vector, it remains unchanged. In the
case of a scalar (<code class="docutils literal notranslate"><span class="pre">nvdim=1</span></code>) field, <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Orientation field.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#discretisedfield.Field" title="discretisedfield.Field">discretisedfield.Field</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<ol class="arabic simple">
<li><p>Computing the orientation field.</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">discretisedfield</span> <span class="k">as</span> <span class="nn">df</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="n">p2</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">mesh</span><span class="p">,</span> <span class="n">nvdim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">orientation</span>
<span class="go">Field(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">array([1.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.phase">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phase</span></span><a class="headerlink" href="#discretisedfield.Field.phase" title="Link to this definition">#</a></dt>
<dd><p>Phase of complex field.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.real">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">real</span></span><a class="headerlink" href="#discretisedfield.Field.real" title="Link to this definition">#</a></dt>
<dd><p>Real part of complex field.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.unit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unit</span></span><a class="headerlink" href="#discretisedfield.Field.unit" title="Link to this definition">#</a></dt>
<dd><p>Unit of the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The unit of the field.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.valid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">valid</span></span><a class="headerlink" href="#discretisedfield.Field.valid" title="Link to this definition">#</a></dt>
<dd><p>Valid field values.</p>
<p>This property is used to mask invalid field values.
This can be achieved by passing <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> of
the same shape as the field array with boolean values,
the string <code class="docutils literal notranslate"><span class="pre">&quot;norm&quot;</span></code> (which masks zero values), or
None (which sets all values to True).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.vdim_mapping">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vdim_mapping</span></span><a class="headerlink" href="#discretisedfield.Field.vdim_mapping" title="Link to this definition">#</a></dt>
<dd><p>Map vdims to dims.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="discretisedfield.Field.vdims">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vdims</span></span><a class="headerlink" href="#discretisedfield.Field.vdims" title="Link to this definition">#</a></dt>
<dd><p>Vector components of the field.</p>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="discretisedfield.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">discretisedfield</p>
      </div>
    </a>
    <a class="right-next"
       href="discretisedfield.FieldRotator.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">FieldRotator</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field"><code class="docutils literal notranslate"><span class="pre">Field</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__abs__"><code class="docutils literal notranslate"><span class="pre">Field.__abs__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__add__"><code class="docutils literal notranslate"><span class="pre">Field.__add__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__array_ufunc__"><code class="docutils literal notranslate"><span class="pre">Field.__array_ufunc__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__call__"><code class="docutils literal notranslate"><span class="pre">Field.__call__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__dir__"><code class="docutils literal notranslate"><span class="pre">Field.__dir__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__eq__"><code class="docutils literal notranslate"><span class="pre">Field.__eq__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__getattr__"><code class="docutils literal notranslate"><span class="pre">Field.__getattr__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__getitem__"><code class="docutils literal notranslate"><span class="pre">Field.__getitem__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__iter__"><code class="docutils literal notranslate"><span class="pre">Field.__iter__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__lshift__"><code class="docutils literal notranslate"><span class="pre">Field.__lshift__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__mul__"><code class="docutils literal notranslate"><span class="pre">Field.__mul__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__neg__"><code class="docutils literal notranslate"><span class="pre">Field.__neg__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__pos__"><code class="docutils literal notranslate"><span class="pre">Field.__pos__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__pow__"><code class="docutils literal notranslate"><span class="pre">Field.__pow__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__repr__"><code class="docutils literal notranslate"><span class="pre">Field.__repr__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__sub__"><code class="docutils literal notranslate"><span class="pre">Field.__sub__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__truediv__"><code class="docutils literal notranslate"><span class="pre">Field.__truediv__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.allclose"><code class="docutils literal notranslate"><span class="pre">Field.allclose()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.angle"><code class="docutils literal notranslate"><span class="pre">Field.angle()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.cross"><code class="docutils literal notranslate"><span class="pre">Field.cross()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.diff"><code class="docutils literal notranslate"><span class="pre">Field.diff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.dot"><code class="docutils literal notranslate"><span class="pre">Field.dot()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.fftn"><code class="docutils literal notranslate"><span class="pre">Field.fftn()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.from_xarray"><code class="docutils literal notranslate"><span class="pre">Field.from_xarray()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.ifftn"><code class="docutils literal notranslate"><span class="pre">Field.ifftn()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.integrate"><code class="docutils literal notranslate"><span class="pre">Field.integrate()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.irfftn"><code class="docutils literal notranslate"><span class="pre">Field.irfftn()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.line"><code class="docutils literal notranslate"><span class="pre">Field.line()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.mean"><code class="docutils literal notranslate"><span class="pre">Field.mean()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.pad"><code class="docutils literal notranslate"><span class="pre">Field.pad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.resample"><code class="docutils literal notranslate"><span class="pre">Field.resample()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.rfftn"><code class="docutils literal notranslate"><span class="pre">Field.rfftn()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.rotate90"><code class="docutils literal notranslate"><span class="pre">Field.rotate90()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.sel"><code class="docutils literal notranslate"><span class="pre">Field.sel()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.to_vtk"><code class="docutils literal notranslate"><span class="pre">Field.to_vtk()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.to_xarray"><code class="docutils literal notranslate"><span class="pre">Field.to_xarray()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.update_field_values"><code class="docutils literal notranslate"><span class="pre">Field.update_field_values()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.__hash__"><code class="docutils literal notranslate"><span class="pre">Field.__hash__</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.abs"><code class="docutils literal notranslate"><span class="pre">Field.abs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.array"><code class="docutils literal notranslate"><span class="pre">Field.array</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.conjugate"><code class="docutils literal notranslate"><span class="pre">Field.conjugate</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.curl"><code class="docutils literal notranslate"><span class="pre">Field.curl</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.div"><code class="docutils literal notranslate"><span class="pre">Field.div</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.grad"><code class="docutils literal notranslate"><span class="pre">Field.grad</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.hv"><code class="docutils literal notranslate"><span class="pre">Field.hv</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.imag"><code class="docutils literal notranslate"><span class="pre">Field.imag</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.k3d"><code class="docutils literal notranslate"><span class="pre">Field.k3d</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.laplace"><code class="docutils literal notranslate"><span class="pre">Field.laplace</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.mesh"><code class="docutils literal notranslate"><span class="pre">Field.mesh</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.mpl"><code class="docutils literal notranslate"><span class="pre">Field.mpl</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.norm"><code class="docutils literal notranslate"><span class="pre">Field.norm</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.nvdim"><code class="docutils literal notranslate"><span class="pre">Field.nvdim</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.orientation"><code class="docutils literal notranslate"><span class="pre">Field.orientation</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.phase"><code class="docutils literal notranslate"><span class="pre">Field.phase</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.real"><code class="docutils literal notranslate"><span class="pre">Field.real</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.unit"><code class="docutils literal notranslate"><span class="pre">Field.unit</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.valid"><code class="docutils literal notranslate"><span class="pre">Field.valid</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.vdim_mapping"><code class="docutils literal notranslate"><span class="pre">Field.vdim_mapping</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discretisedfield.Field.vdims"><code class="docutils literal notranslate"><span class="pre">Field.vdims</span></code></a></li>
</ul>
</li>
</ul>
</nav>

</div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/api/_autosummary/discretisedfield.Field.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2022, Marijan Beg and Hans Fangohr.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>